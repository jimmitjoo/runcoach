{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/classCallCheck.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/createClass.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/defineProperty.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/inherits.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/helpers/typeof.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/@babel/runtime/regenerator/index.js","webpack:///@wordpress/url/src/add-query-args.js","webpack:///@wordpress/url/src/filter-url-for-display.js","webpack:///@wordpress/url/src/get-authority.js","webpack:///@wordpress/url/src/get-fragment.js","webpack:///@wordpress/url/src/get-path.js","webpack:///@wordpress/url/src/get-protocol.js","webpack:///@wordpress/url/src/get-query-arg.js","webpack:///@wordpress/url/src/get-query-string.js","webpack:///@wordpress/url/src/has-query-arg.js","webpack:///@wordpress/url/src/index.js","webpack:///@wordpress/url/src/is-email.js","webpack:///@wordpress/url/src/is-url.js","webpack:///@wordpress/url/src/is-valid-authority.js","webpack:///@wordpress/url/src/is-valid-fragment.js","webpack:///@wordpress/url/src/is-valid-path.js","webpack:///@wordpress/url/src/is-valid-protocol.js","webpack:///@wordpress/url/src/is-valid-query-string.js","webpack:///@wordpress/url/src/prepend-http.js","webpack:///@wordpress/url/src/remove-query-args.js","webpack:///@wordpress/url/src/safe-decode-uri-component.js","webpack:///@wordpress/url/src/safe-decode-uri.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/form-serialize/index.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/qs/lib/formats.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/qs/lib/index.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/qs/lib/parse.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/qs/lib/stringify.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/qs/lib/utils.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/node_modules/regenerator-runtime/runtime.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/includes/core/assets/js/frontend/payments/customer.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/includes/core/assets/js/packages/cart/src/cart.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/includes/core/assets/js/packages/cart/src/index.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/includes/core/assets/js/packages/cart/src/line-item.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/includes/core/assets/js/packages/utils/src/api-request.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/includes/core/assets/js/packages/utils/src/index.js","webpack:////Users/spencerfinnell/dev/wpsimplepay/wp-content/plugins/wp-simple-pay-pro/includes/core/assets/js/packages/utils/src/number.js","webpack:///./js/frontend/compat.js","webpack:///./js/frontend/components/address.js","webpack:///./js/frontend/components/amount.js","webpack:///./js/frontend/components/coupon.js","webpack:///./js/frontend/components/custom-amount.js","webpack:///./js/frontend/components/date.js","webpack:///./js/frontend/components/multi-sub.js","webpack:///./js/frontend/components/payment-request-button.js","webpack:///./js/frontend/components/quantity.js","webpack:///./js/frontend/components/total-amount-labels.js","webpack:///./js/frontend/index.js","webpack:///./js/frontend/payment-forms/stripe-elements/index.js","webpack:///./js/frontend/payment-forms/stripe-elements/overlays.js","webpack:///./js/frontend/payment-methods/card/cart/index.js","webpack:///./js/frontend/payment-methods/card/cart/line-item.js","webpack:///./js/frontend/payment-methods/card/index.js","webpack:///./js/frontend/payments/paymentintent.js","webpack:///./js/frontend/payments/subscription.js","webpack:///external \"jQuery\""],"names":["addQueryArgs","url","args","Object","keys","length","baseUrl","queryStringIndex","indexOf","assign","parse","substr","stringify","filterURLForDisplay","filteredURL","replace","match","getAuthority","matches","exec","getFragment","getPath","getProtocol","getQueryArg","arg","query","getQueryString","hasQueryArg","undefined","EMAIL_REGEXP","isEmail","email","test","URL_REGEXP","isURL","isValidAuthority","authority","isValidFragment","fragment","isValidPath","path","isValidProtocol","protocol","isValidQueryString","queryString","USABLE_HREF_REGEXP","prependHTTP","trim","removeQueryArgs","forEach","safeDecodeURIComponent","uriComponent","decodeURIComponent","uriComponentError","safeDecodeURI","uri","decodeURI","uriError","create","data","spFormElem","formData","apiRequest","form_values","serialize","hash","form_data","form_id","formId","Cart","items","currency","taxPercent","coupon","isNonDecimalCurrency","update","id","message","isNaN","parseFloat","getLineItems","filteredItems","filter","itemId","item","lineitem","LineItem","push","convertFormDataToCartData","window","spShared","debugLog","convertToCents","spGeneral","booleans","isZeroDecimal","stripeParams","amount","isSubscription","quantity","isTrial","planInterval","planIntervalCount","feePercent","feeAmount","setupFee","title","subscription","interval","intervalCount","singleAmount","cart","Number","isSafeInteger","allItems","remainingItems","tax","i","taxDecimal","getTaxDecimal","getQuantity","subtotal","getSubtotal","Math","round","route","jQuery","ajax","method","wpApiSettings","root","beforeSend","xhr","setRequestHeader","nonce","isInteger","value","isFinite","floor","abs","MAX_SAFE_INTEGER","doNothingFuncs","_","extend","reduce","memo","func","isCustomAmountFieldValid","updateCustomAmount","initDateField","setupDateField","handleCustomAmountFocusIn","enableCustomPlanAmount","processCustomAmount","updateAmountSelect","updateAmountField","updateQuantitySelect","updateQuantityField","updateTotalAmountLabel","updateTotalAmountLabels","updateRecurringAmountLabel","updateTaxAmountLabel","changeMultiSubAmount","updateMultiSubSelection","enablePaymentRequestButton","bindProFormEventsAndTriggers","e","simpayAppPro","bindEvents","handleFieldFocus","setOnFieldFocus","enableForm","simpayApp","disableForm","setSubmitButtonAsLoading","triggerBrowserValidation","setProFinalAmount","updateAmounts","calculateTaxAmount","percent","accounting","toFixed","integers","decimalPlaces","updatePaymentRequestButton","paymentRequestIsValid","getPaymentRequestDisplayItems","toggleShippingAddressFields","applyCoupon","removeCoupon","toggleOverlayForm","shippingAddressContainer","find","isChecked","is","toggle","prop","trigger","getLineItem","error","apply","$","couponField","responseContainer","loadingImage","hiddenCouponElem","couponMessage","val","couponCode","action","couponNonce","text","hide","show","strings","ajaxurl","dataType","success","response","discount","stripeCoupon","formatCurrency","code","type","amountOff","i18n","couponPercentOffText","couponAmountOffText","remove","append","name","class","appendTo","addClass","errorMessage","responseText","complete","triggerTotalsChanged","customAmountInput","errorEl","unformatCurrency","unformattedAmount","customAmount","subMinAmount","planAmount","customPlanAmount","minAmount","isValid","customAmountVal","empty","removeClass","html","subMinCustomAmountError","minCustomAmountError","customOption","useCustomPlan","setup","datepicker","dateInputEl","dateFormat","beforeShow","css","wrapperElem","options","selectedOption","planId","planName","planSetupFee","planTrial","planMaxCharges","first","hasClass","focus","setupFeeItem","formInstance","formDisplayType","country","hasPaymentRequestButton","requestPayerName","requestPayerEmail","requestShipping","shippingOptions","paymentRequestButtons","stripe","stripeInstance","stripeElements","elements","key","paymentRequest","toLowerCase","total","label","totalLabel","getTotal","displayItems","getDisplayItems","prButton","style","paymentRequestButton","canMakePayment","then","result","containers","document","querySelectorAll","each","container","display","toMount","buttons","querySelector","innerHTML","mount","on","preventDefault","isCustomAmountValid","updateWith","status","payerEmail","payerName","attr","handleSource","hasOwnProperty","isClassicField","control","classicFields","classList","className","requiredFieldsValid","classicField","inputs","input","required","validity","valid","plan","planLabel","setupFeeAmount","setupFeeLabel","taxLabel","getTaxPercent","getTax","getDiscount","couponLabel","getCoupon","totalAmount","recurringAmount","taxAmount","convertToDollars","formatted","setCoreFinalAmount","recurringAmountFinal","recurringAmountFormatted","cartTotal","body","init","bind","setupPaymentForm","setupOverlayModals","_removeCoupon","updatePaymentRequestButtons","which","isRecurring","target","checked","fields","el","field","setFocus","removeFocus","$el","setTimeout","finalAmount","simpayAppProCompat","ELEMENTS_DEFAULT_STYLE","base","color","fontFamily","fontSize","fontSmoothing","fontWeight","invalid","iconColor","getElementsStyle","cardEl","getElementById","styleTag","createElement","appendChild","inputStyles","getComputedStyle","placeholderStyles","trbl","map","dir","getPropertyValue","corners","corner","join","getElementsConfig","hidePostalCode","dataset","showPostalCode","onError","isObject","responseJSON","foundMessage","showError","onSubmit","checkValidity","createCardPaymentMethod","handleCardPaymentMethod","catch","isStripeCheckoutForm","realFormElem","submitBtn","addLineItem","setupCardPaymentMethod","addEventListener","modal","modalStyles","isVisible","opacity","height","spFormElems","spFormData","setupPaymentRequestButton","focusFirstField","SELECTOR","firstModalField","parentElement","add","OVERLAYS_SETUP","inputControls","controls","amount_off","percentOff","percent_off","lineItems","lineItemDiscount","lineItemSubtotal","cartSubtotal","BaseCart","getUnitPrice","BaseLineItem","handle","createCustomer","source_id","source","customer","successUrl","success_url","customer_id","createSubscription","handleSubscriptionServerResponse","paymentIntentRequiresAction","createPaymentIntent","payment_method_id","paymentIntent","requires_action","location","href","handlePaymentIntentServerResponse","payment_intent","cardElementInstance","owner","getOwnerData","createSource","billingAddressContainer","phone","address","line1","city","state","postal_code","confirm","handleServerResponse","handleCardAction","payment_intent_client_secret","paymentIntentAction","payment_intent_id","paymentIntentConfirmation","updatePaymentMethod","subscription_id","latest_invoice","setupIntent","pending_setup_intent","errorUrl","error_url","paymentIntentStatus","paymentIntentClientSecret","client_secret","paymentIntentError","last_payment_error","handleCardPayment","setupIntentStatus","setupIntentClientSecret","handleCardSetup"],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,wC;;;;;;;;;;;ACRA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;;AAEA,mC;;;;;;;;;;;ACpCA;AACA;AACA;AACA;AACA;;AAEA,iC;;;;;;;;;;;ACNA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,8B;;;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA;;AAEA,iC;;;;;;;;;;;ACfA;AACA;AACA;AACA;AACA;AACA;;AAEA,iC;;;;;;;;;;;ACPA,qBAAqB,mBAAO,CAAC,wFAAkB;;AAE/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,2B;;;;;;;;;;;ACjBA,cAAc,mBAAO,CAAC,iFAAmB;;AAEzC,4BAA4B,mBAAO,CAAC,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;AAEA;AACA;AACA;;AAEA;AACA;AACA,0BAA0B,yBAAyB;AACnD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;ACnQa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;;ACjBa;;AAEb,gBAAgB,mBAAO,CAAC,8DAAa;AACrC,YAAY,mBAAO,CAAC,sDAAS;AAC7B,cAAc,mBAAO,CAAC,0DAAW;;AAEjC;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACVa;;AAEb,YAAY,mBAAO,CAAC,sDAAS;;AAE7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,kBAAkB;AACrC;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,kCAAkC,QAAQ;AAC1C;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,wCAAwC;;AAExC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;AC7Ka;;AAEb,YAAY,mBAAO,CAAC,sDAAS;AAC7B,cAAc,mBAAO,CAAC,0DAAW;;AAEjC;AACA,yCAAyC;AACzC;AACA,KAAK;AACL,4CAA4C;AAC5C;AACA,KAAK;AACL,qCAAqC;AACrC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA,mBAAmB,oBAAoB;AACvC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,wCAAwC;;AAExC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,oBAAoB;AACvC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;ACjNa;;AAEb;;AAEA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,2BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,mBAAmB,mBAAmB;AACtC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,kBAAkB,OAAO,WAAW,aAAa;AACjD;;AAEA,mBAAmB,kBAAkB;AACrC;AACA;;AAEA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA,4BAA4B,sBAAsB;AAClD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACpNA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,KAAK;AACL,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;;AAEA;AACA;AACA,wCAAwC,WAAW;AACnD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oCAAoC,cAAc;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,iCAAiC,kBAAkB;AACnD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,8CAA8C,QAAQ;AACtD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,8CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA,KAAK;;AAEL;AACA,8CAA8C,QAAQ;AACtD;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","file":"simpay-public-pro.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./js/frontend/index.js\");\n","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","module.exports = require(\"regenerator-runtime\");\n","/**\n * External dependencies\n */\nimport { parse, stringify } from 'qs';\n\n/**\n * Appends arguments as querystring to the provided URL. If the URL already\n * includes query arguments, the arguments are merged with (and take precedent\n * over) the existing set.\n *\n * @param {string} [url='']  URL to which arguments should be appended. If omitted,\n *                           only the resulting querystring is returned.\n * @param {Object} args      Query arguments to apply to URL.\n *\n * @example\n * ```js\n * const newURL = addQueryArgs( 'https://google.com', { q: 'test' } ); // https://google.com/?q=test\n * ```\n *\n * @return {string} URL with arguments applied.\n */\nexport function addQueryArgs( url = '', args ) {\n\t// If no arguments are to be appended, return original URL.\n\tif ( ! args || ! Object.keys( args ).length ) {\n\t\treturn url;\n\t}\n\n\tlet baseUrl = url;\n\n\t// Determine whether URL already had query arguments.\n\tconst queryStringIndex = url.indexOf( '?' );\n\tif ( queryStringIndex !== -1 ) {\n\t\t// Merge into existing query arguments.\n\t\targs = Object.assign(\n\t\t\tparse( url.substr( queryStringIndex + 1 ) ),\n\t\t\targs\n\t\t);\n\n\t\t// Change working base URL to omit previous query arguments.\n\t\tbaseUrl = baseUrl.substr( 0, queryStringIndex );\n\t}\n\n\treturn baseUrl + '?' + stringify( args );\n}\n","/**\n * Returns a URL for display.\n *\n * @param {string} url Original URL.\n *\n * @example\n * ```js\n * const displayUrl = filterURLForDisplay( 'https://www.wordpress.org/gutenberg/' ); // wordpress.org/gutenberg\n * ```\n *\n * @return {string} Displayed URL.\n */\nexport function filterURLForDisplay( url ) {\n\t// Remove protocol and www prefixes.\n\tconst filteredURL = url.replace( /^(?:https?:)\\/\\/(?:www\\.)?/, '' );\n\n\t// Ends with / and only has that single slash, strip it.\n\tif ( filteredURL.match( /^[^\\/]+\\/$/ ) ) {\n\t\treturn filteredURL.replace( '/', '' );\n\t}\n\n\treturn filteredURL;\n}\n","/**\n * Returns the authority part of the URL.\n *\n * @param {string} url The full URL.\n *\n * @example\n * ```js\n * const authority1 = getAuthority( 'https://wordpress.org/help/' ); // 'wordpress.org'\n * const authority2 = getAuthority( 'https://localhost:8080/test/' ); // 'localhost:8080'\n * ```\n *\n * @return {string|void} The authority part of the URL.\n */\nexport function getAuthority( url ) {\n\tconst matches = /^[^\\/\\s:]+:(?:\\/\\/)?\\/?([^\\/\\s#?]+)[\\/#?]{0,1}\\S*$/.exec( url );\n\tif ( matches ) {\n\t\treturn matches[ 1 ];\n\t}\n}\n","/**\n * Returns the fragment part of the URL.\n *\n * @param {string} url The full URL\n *\n * @example\n * ```js\n * const fragment1 = getFragment( 'http://localhost:8080/this/is/a/test?query=true#fragment' ); // '#fragment'\n * const fragment2 = getFragment( 'https://wordpress.org#another-fragment?query=true' ); // '#another-fragment'\n * ```\n *\n * @return {string|void} The fragment part of the URL.\n */\nexport function getFragment( url ) {\n\tconst matches = /^\\S+?(#[^\\s\\?]*)/.exec( url );\n\tif ( matches ) {\n\t\treturn matches[ 1 ];\n\t}\n}\n","/**\n * Returns the path part of the URL.\n *\n * @param {string} url The full URL.\n *\n * @example\n * ```js\n * const path1 = getPath( 'http://localhost:8080/this/is/a/test?query=true' ); // 'this/is/a/test'\n * const path2 = getPath( 'https://wordpress.org/help/faq/' ); // 'help/faq'\n * ```\n *\n * @return {string|void} The path part of the URL.\n */\nexport function getPath( url ) {\n\tconst matches = /^[^\\/\\s:]+:(?:\\/\\/)?[^\\/\\s#?]+[\\/]([^\\s#?]+)[#?]{0,1}\\S*$/.exec( url );\n\tif ( matches ) {\n\t\treturn matches[ 1 ];\n\t}\n}\n","/**\n * Returns the protocol part of the URL.\n *\n * @param {string} url The full URL.\n *\n * @example\n * ```js\n * const protocol1 = getProtocol( 'tel:012345678' ); // 'tel:'\n * const protocol2 = getProtocol( 'https://wordpress.org' ); // 'https:'\n * ```\n *\n * @return {string|void} The protocol part of the URL.\n */\nexport function getProtocol( url ) {\n\tconst matches = /^([^\\s:]+:)/.exec( url );\n\tif ( matches ) {\n\t\treturn matches[ 1 ];\n\t}\n}\n","/**\n * External dependencies\n */\nimport { parse } from 'qs';\n\n/**\n * @typedef {{[key: string]: QueryArgParsed}} QueryArgObject\n */\n\n/**\n * @typedef {string|string[]|QueryArgObject} QueryArgParsed\n */\n\n/**\n * Returns a single query argument of the url\n *\n * @param {string} url URL.\n * @param {string} arg Query arg name.\n *\n * @example\n * ```js\n * const foo = getQueryArg( 'https://wordpress.org?foo=bar&bar=baz', 'foo' ); // bar\n * ```\n *\n * @return {QueryArgParsed|undefined} Query arg value.\n */\nexport function getQueryArg( url, arg ) {\n\tconst queryStringIndex = url.indexOf( '?' );\n\tconst query = queryStringIndex !== -1 ? parse( url.substr( queryStringIndex + 1 ) ) : {};\n\n\treturn query[ arg ];\n}\n","/**\n * Returns the query string part of the URL.\n *\n * @param {string} url The full URL.\n *\n * @example\n * ```js\n * const queryString1 = getQueryString( 'http://localhost:8080/this/is/a/test?query=true#fragment' ); // 'query=true'\n * const queryString2 = getQueryString( 'https://wordpress.org#fragment?query=false&search=hello' ); // 'query=false&search=hello'\n * ```\n *\n * @return {string|void} The query string part of the URL.\n */\nexport function getQueryString( url ) {\n\tconst matches = /^\\S+?\\?([^\\s#]+)/.exec( url );\n\tif ( matches ) {\n\t\treturn matches[ 1 ];\n\t}\n}\n","/**\n * Internal dependencies\n */\nimport { getQueryArg } from './get-query-arg';\n\n/**\n * Determines whether the URL contains a given query arg.\n *\n * @param {string} url URL.\n * @param {string} arg Query arg name.\n *\n * @example\n * ```js\n * const hasBar = hasQueryArg( 'https://wordpress.org?foo=bar&bar=baz', 'bar' ); // true\n * ```\n *\n * @return {boolean} Whether or not the URL contains the query arg.\n */\nexport function hasQueryArg( url, arg ) {\n\treturn getQueryArg( url, arg ) !== undefined;\n}\n","export { isURL } from './is-url';\nexport { isEmail } from './is-email';\nexport { getProtocol } from './get-protocol';\nexport { isValidProtocol } from './is-valid-protocol';\nexport { getAuthority } from './get-authority';\nexport { isValidAuthority } from './is-valid-authority';\nexport { getPath } from './get-path';\nexport { isValidPath } from './is-valid-path';\nexport { getQueryString } from './get-query-string';\nexport { isValidQueryString } from './is-valid-query-string';\nexport { getFragment } from './get-fragment';\nexport { isValidFragment } from './is-valid-fragment';\nexport { addQueryArgs } from './add-query-args';\nexport { getQueryArg } from './get-query-arg';\nexport { hasQueryArg } from './has-query-arg';\nexport { removeQueryArgs } from './remove-query-args';\nexport { prependHTTP } from './prepend-http';\nexport { safeDecodeURI } from './safe-decode-uri';\nexport { safeDecodeURIComponent } from './safe-decode-uri-component';\nexport { filterURLForDisplay } from './filter-url-for-display';\n","const EMAIL_REGEXP = /^(mailto:)?[a-z0-9._%+-]+@[a-z0-9][a-z0-9.-]*\\.[a-z]{2,63}$/i;\n\n/**\n * Determines whether the given string looks like an email.\n *\n * @param {string} email The string to scrutinise.\n *\n * @example\n * ```js\n * const isEmail = isEmail( 'hello@wordpress.org' ); // true\n * ```\n *\n * @return {boolean} Whether or not it looks like an email.\n */\nexport function isEmail( email ) {\n\treturn EMAIL_REGEXP.test( email );\n}\n","const URL_REGEXP = /^(?:https?:)?\\/\\/\\S+$/i;\n\n/**\n * Determines whether the given string looks like a URL.\n *\n * @param {string} url The string to scrutinise.\n *\n * @example\n * ```js\n * const isURL = isURL( 'https://wordpress.org' ); // true\n * ```\n *\n * @return {boolean} Whether or not it looks like a URL.\n */\nexport function isURL( url ) {\n\treturn URL_REGEXP.test( url );\n}\n","/**\n * Checks for invalid characters within the provided authority.\n *\n * @param {string} authority A string containing the URL authority.\n *\n * @example\n * ```js\n * const isValid = isValidAuthority( 'wordpress.org' ); // true\n * const isNotValid = isValidAuthority( 'wordpress#org' ); // false\n * ```\n *\n * @return {boolean} True if the argument contains a valid authority.\n */\nexport function isValidAuthority( authority ) {\n\tif ( ! authority ) {\n\t\treturn false;\n\t}\n\treturn /^[^\\s#?]+$/.test( authority );\n}\n","/**\n * Checks for invalid characters within the provided fragment.\n *\n * @param {string} fragment The url fragment.\n *\n * @example\n * ```js\n * const isValid = isValidFragment( '#valid-fragment' ); // true\n * const isNotValid = isValidFragment( '#invalid-#fragment' ); // false\n * ```\n *\n * @return {boolean} True if the argument contains a valid fragment.\n */\nexport function isValidFragment( fragment ) {\n\tif ( ! fragment ) {\n\t\treturn false;\n\t}\n\treturn /^#[^\\s#?\\/]*$/.test( fragment );\n}\n","/**\n * Checks for invalid characters within the provided path.\n *\n * @param {string} path The URL path.\n *\n * @example\n * ```js\n * const isValid = isValidPath( 'test/path/' ); // true\n * const isNotValid = isValidPath( '/invalid?test/path/' ); // false\n * ```\n *\n * @return {boolean} True if the argument contains a valid path\n */\nexport function isValidPath( path ) {\n\tif ( ! path ) {\n\t\treturn false;\n\t}\n\treturn /^[^\\s#?]+$/.test( path );\n}\n","/**\n * Tests if a url protocol is valid.\n *\n * @param {string} protocol The url protocol.\n *\n * @example\n * ```js\n * const isValid = isValidProtocol( 'https:' ); // true\n * const isNotValid = isValidProtocol( 'https :' ); // false\n * ```\n *\n * @return {boolean} True if the argument is a valid protocol (e.g. http:, tel:).\n */\nexport function isValidProtocol( protocol ) {\n\tif ( ! protocol ) {\n\t\treturn false;\n\t}\n\treturn /^[a-z\\-.\\+]+[0-9]*:$/i.test( protocol );\n}\n","/**\n * Checks for invalid characters within the provided query string.\n *\n * @param {string} queryString The query string.\n *\n * @example\n * ```js\n * const isValid = isValidQueryString( 'query=true&another=false' ); // true\n * const isNotValid = isValidQueryString( 'query=true?another=false' ); // false\n * ```\n *\n * @return {boolean} True if the argument contains a valid query string.\n */\nexport function isValidQueryString( queryString ) {\n\tif ( ! queryString ) {\n\t\treturn false;\n\t}\n\treturn /^[^\\s#?\\/]+$/.test( queryString );\n}\n","/**\n * Internal dependencies\n */\nimport { isEmail } from './is-email';\n\nconst USABLE_HREF_REGEXP = /^(?:[a-z]+:|#|\\?|\\.|\\/)/i;\n\n/**\n * Prepends \"http://\" to a url, if it looks like something that is meant to be a TLD.\n *\n * @param {string} url The URL to test.\n *\n * @example\n * ```js\n * const actualURL = prependHTTP( 'wordpress.org' ); // http://wordpress.org\n * ```\n *\n * @return {string} The updated URL.\n */\nexport function prependHTTP( url ) {\n\tif ( ! url ) {\n\t\treturn url;\n\t}\n\n\turl = url.trim();\n\tif ( ! USABLE_HREF_REGEXP.test( url ) && ! isEmail( url ) ) {\n\t\treturn 'http://' + url;\n\t}\n\n\treturn url;\n}\n","/**\n * External dependencies\n */\nimport { parse, stringify } from 'qs';\n\n/**\n * Removes arguments from the query string of the url\n *\n * @param {string}    url  URL.\n * @param {...string} args Query Args.\n *\n * @example\n * ```js\n * const newUrl = removeQueryArgs( 'https://wordpress.org?foo=bar&bar=baz&baz=foobar', 'foo', 'bar' ); // https://wordpress.org?baz=foobar\n * ```\n *\n * @return {string} Updated URL.\n */\nexport function removeQueryArgs( url, ...args ) {\n\tconst queryStringIndex = url.indexOf( '?' );\n\tconst query = queryStringIndex !== -1 ? parse( url.substr( queryStringIndex + 1 ) ) : {};\n\tconst baseUrl = queryStringIndex !== -1 ? url.substr( 0, queryStringIndex ) : url;\n\n\targs.forEach( ( arg ) => delete query[ arg ] );\n\n\treturn baseUrl + '?' + stringify( query );\n}\n","/**\n * Safely decodes a URI component with `decodeURIComponent`. Returns the URI component unmodified if\n * `decodeURIComponent` throws an error.\n *\n * @param {string} uriComponent URI component to decode.\n *\n * @return {string} Decoded URI component if possible.\n */\nexport function safeDecodeURIComponent( uriComponent ) {\n\ttry {\n\t\treturn decodeURIComponent( uriComponent );\n\t} catch ( uriComponentError ) {\n\t\treturn uriComponent;\n\t}\n}\n","/**\n * Safely decodes a URI with `decodeURI`. Returns the URI unmodified if\n * `decodeURI` throws an error.\n *\n * @param {string} uri URI to decode.\n *\n * @example\n * ```js\n * const badUri = safeDecodeURI( '%z' ); // does not throw an Error, simply returns '%z'\n * ```\n *\n * @return {string} Decoded URI if possible.\n */\nexport function safeDecodeURI( uri ) {\n\ttry {\n\t\treturn decodeURI( uri );\n\t} catch ( uriError ) {\n\t\treturn uri;\n\t}\n}\n","// get successful control from form and assemble into object\n// http://www.w3.org/TR/html401/interact/forms.html#h-17.13.2\n\n// types which indicate a submit action and are not successful controls\n// these will be ignored\nvar k_r_submitter = /^(?:submit|button|image|reset|file)$/i;\n\n// node names which could be successful controls\nvar k_r_success_contrls = /^(?:input|select|textarea|keygen)/i;\n\n// Matches bracket notation.\nvar brackets = /(\\[[^\\[\\]]*\\])/g;\n\n// serializes form fields\n// @param form MUST be an HTMLForm element\n// @param options is an optional argument to configure the serialization. Default output\n// with no options specified is a url encoded string\n//    - hash: [true | false] Configure the output type. If true, the output will\n//    be a js object.\n//    - serializer: [function] Optional serializer function to override the default one.\n//    The function takes 3 arguments (result, key, value) and should return new result\n//    hash and url encoded str serializers are provided with this module\n//    - disabled: [true | false]. If true serialize disabled fields.\n//    - empty: [true | false]. If true serialize empty fields\nfunction serialize(form, options) {\n    if (typeof options != 'object') {\n        options = { hash: !!options };\n    }\n    else if (options.hash === undefined) {\n        options.hash = true;\n    }\n\n    var result = (options.hash) ? {} : '';\n    var serializer = options.serializer || ((options.hash) ? hash_serializer : str_serialize);\n\n    var elements = form && form.elements ? form.elements : [];\n\n    //Object store each radio and set if it's empty or not\n    var radio_store = Object.create(null);\n\n    for (var i=0 ; i<elements.length ; ++i) {\n        var element = elements[i];\n\n        // ingore disabled fields\n        if ((!options.disabled && element.disabled) || !element.name) {\n            continue;\n        }\n        // ignore anyhting that is not considered a success field\n        if (!k_r_success_contrls.test(element.nodeName) ||\n            k_r_submitter.test(element.type)) {\n            continue;\n        }\n\n        var key = element.name;\n        var val = element.value;\n\n        // we can't just use element.value for checkboxes cause some browsers lie to us\n        // they say \"on\" for value when the box isn't checked\n        if ((element.type === 'checkbox' || element.type === 'radio') && !element.checked) {\n            val = undefined;\n        }\n\n        // If we want empty elements\n        if (options.empty) {\n            // for checkbox\n            if (element.type === 'checkbox' && !element.checked) {\n                val = '';\n            }\n\n            // for radio\n            if (element.type === 'radio') {\n                if (!radio_store[element.name] && !element.checked) {\n                    radio_store[element.name] = false;\n                }\n                else if (element.checked) {\n                    radio_store[element.name] = true;\n                }\n            }\n\n            // if options empty is true, continue only if its radio\n            if (val == undefined && element.type == 'radio') {\n                continue;\n            }\n        }\n        else {\n            // value-less fields are ignored unless options.empty is true\n            if (!val) {\n                continue;\n            }\n        }\n\n        // multi select boxes\n        if (element.type === 'select-multiple') {\n            val = [];\n\n            var selectOptions = element.options;\n            var isSelectedOptions = false;\n            for (var j=0 ; j<selectOptions.length ; ++j) {\n                var option = selectOptions[j];\n                var allowedEmpty = options.empty && !option.value;\n                var hasValue = (option.value || allowedEmpty);\n                if (option.selected && hasValue) {\n                    isSelectedOptions = true;\n\n                    // If using a hash serializer be sure to add the\n                    // correct notation for an array in the multi-select\n                    // context. Here the name attribute on the select element\n                    // might be missing the trailing bracket pair. Both names\n                    // \"foo\" and \"foo[]\" should be arrays.\n                    if (options.hash && key.slice(key.length - 2) !== '[]') {\n                        result = serializer(result, key + '[]', option.value);\n                    }\n                    else {\n                        result = serializer(result, key, option.value);\n                    }\n                }\n            }\n\n            // Serialize if no selected options and options.empty is true\n            if (!isSelectedOptions && options.empty) {\n                result = serializer(result, key, '');\n            }\n\n            continue;\n        }\n\n        result = serializer(result, key, val);\n    }\n\n    // Check for all empty radio buttons and serialize them with key=\"\"\n    if (options.empty) {\n        for (var key in radio_store) {\n            if (!radio_store[key]) {\n                result = serializer(result, key, '');\n            }\n        }\n    }\n\n    return result;\n}\n\nfunction parse_keys(string) {\n    var keys = [];\n    var prefix = /^([^\\[\\]]*)/;\n    var children = new RegExp(brackets);\n    var match = prefix.exec(string);\n\n    if (match[1]) {\n        keys.push(match[1]);\n    }\n\n    while ((match = children.exec(string)) !== null) {\n        keys.push(match[1]);\n    }\n\n    return keys;\n}\n\nfunction hash_assign(result, keys, value) {\n    if (keys.length === 0) {\n        result = value;\n        return result;\n    }\n\n    var key = keys.shift();\n    var between = key.match(/^\\[(.+?)\\]$/);\n\n    if (key === '[]') {\n        result = result || [];\n\n        if (Array.isArray(result)) {\n            result.push(hash_assign(null, keys, value));\n        }\n        else {\n            // This might be the result of bad name attributes like \"[][foo]\",\n            // in this case the original `result` object will already be\n            // assigned to an object literal. Rather than coerce the object to\n            // an array, or cause an exception the attribute \"_values\" is\n            // assigned as an array.\n            result._values = result._values || [];\n            result._values.push(hash_assign(null, keys, value));\n        }\n\n        return result;\n    }\n\n    // Key is an attribute name and can be assigned directly.\n    if (!between) {\n        result[key] = hash_assign(result[key], keys, value);\n    }\n    else {\n        var string = between[1];\n        // +var converts the variable into a number\n        // better than parseInt because it doesn't truncate away trailing\n        // letters and actually fails if whole thing is not a number\n        var index = +string;\n\n        // If the characters between the brackets is not a number it is an\n        // attribute name and can be assigned directly.\n        if (isNaN(index)) {\n            result = result || {};\n            result[string] = hash_assign(result[string], keys, value);\n        }\n        else {\n            result = result || [];\n            result[index] = hash_assign(result[index], keys, value);\n        }\n    }\n\n    return result;\n}\n\n// Object/hash encoding serializer.\nfunction hash_serializer(result, key, value) {\n    var matches = key.match(brackets);\n\n    // Has brackets? Use the recursive assignment function to walk the keys,\n    // construct any missing objects in the result tree and make the assignment\n    // at the end of the chain.\n    if (matches) {\n        var keys = parse_keys(key);\n        hash_assign(result, keys, value);\n    }\n    else {\n        // Non bracket notation can make assignments directly.\n        var existing = result[key];\n\n        // If the value has been assigned already (for instance when a radio and\n        // a checkbox have the same name attribute) convert the previous value\n        // into an array before pushing into it.\n        //\n        // NOTE: If this requirement were removed all hash creation and\n        // assignment could go through `hash_assign`.\n        if (existing) {\n            if (!Array.isArray(existing)) {\n                result[key] = [ existing ];\n            }\n\n            result[key].push(value);\n        }\n        else {\n            result[key] = value;\n        }\n    }\n\n    return result;\n}\n\n// urlform encoding serializer\nfunction str_serialize(result, key, value) {\n    // encode newlines as \\r\\n cause the html spec says so\n    value = value.replace(/(\\r)?\\n/g, '\\r\\n');\n    value = encodeURIComponent(value);\n\n    // spaces should be '+' rather than '%20'.\n    value = value.replace(/%20/g, '+');\n    return result + (result ? '&' : '') + encodeURIComponent(key) + '=' + value;\n}\n\nmodule.exports = serialize;\n","'use strict';\n\nvar replace = String.prototype.replace;\nvar percentTwenties = /%20/g;\n\nmodule.exports = {\n    'default': 'RFC3986',\n    formatters: {\n        RFC1738: function (value) {\n            return replace.call(value, percentTwenties, '+');\n        },\n        RFC3986: function (value) {\n            return value;\n        }\n    },\n    RFC1738: 'RFC1738',\n    RFC3986: 'RFC3986'\n};\n","'use strict';\n\nvar stringify = require('./stringify');\nvar parse = require('./parse');\nvar formats = require('./formats');\n\nmodule.exports = {\n    formats: formats,\n    parse: parse,\n    stringify: stringify\n};\n","'use strict';\n\nvar utils = require('./utils');\n\nvar has = Object.prototype.hasOwnProperty;\n\nvar defaults = {\n    allowDots: false,\n    allowPrototypes: false,\n    arrayLimit: 20,\n    decoder: utils.decode,\n    delimiter: '&',\n    depth: 5,\n    parameterLimit: 1000,\n    plainObjects: false,\n    strictNullHandling: false\n};\n\nvar parseValues = function parseQueryStringValues(str, options) {\n    var obj = {};\n    var cleanStr = options.ignoreQueryPrefix ? str.replace(/^\\?/, '') : str;\n    var limit = options.parameterLimit === Infinity ? undefined : options.parameterLimit;\n    var parts = cleanStr.split(options.delimiter, limit);\n\n    for (var i = 0; i < parts.length; ++i) {\n        var part = parts[i];\n\n        var bracketEqualsPos = part.indexOf(']=');\n        var pos = bracketEqualsPos === -1 ? part.indexOf('=') : bracketEqualsPos + 1;\n\n        var key, val;\n        if (pos === -1) {\n            key = options.decoder(part, defaults.decoder);\n            val = options.strictNullHandling ? null : '';\n        } else {\n            key = options.decoder(part.slice(0, pos), defaults.decoder);\n            val = options.decoder(part.slice(pos + 1), defaults.decoder);\n        }\n        if (has.call(obj, key)) {\n            obj[key] = [].concat(obj[key]).concat(val);\n        } else {\n            obj[key] = val;\n        }\n    }\n\n    return obj;\n};\n\nvar parseObject = function (chain, val, options) {\n    var leaf = val;\n\n    for (var i = chain.length - 1; i >= 0; --i) {\n        var obj;\n        var root = chain[i];\n\n        if (root === '[]') {\n            obj = [];\n            obj = obj.concat(leaf);\n        } else {\n            obj = options.plainObjects ? Object.create(null) : {};\n            var cleanRoot = root.charAt(0) === '[' && root.charAt(root.length - 1) === ']' ? root.slice(1, -1) : root;\n            var index = parseInt(cleanRoot, 10);\n            if (\n                !isNaN(index)\n                && root !== cleanRoot\n                && String(index) === cleanRoot\n                && index >= 0\n                && (options.parseArrays && index <= options.arrayLimit)\n            ) {\n                obj = [];\n                obj[index] = leaf;\n            } else {\n                obj[cleanRoot] = leaf;\n            }\n        }\n\n        leaf = obj;\n    }\n\n    return leaf;\n};\n\nvar parseKeys = function parseQueryStringKeys(givenKey, val, options) {\n    if (!givenKey) {\n        return;\n    }\n\n    // Transform dot notation to bracket notation\n    var key = options.allowDots ? givenKey.replace(/\\.([^.[]+)/g, '[$1]') : givenKey;\n\n    // The regex chunks\n\n    var brackets = /(\\[[^[\\]]*])/;\n    var child = /(\\[[^[\\]]*])/g;\n\n    // Get the parent\n\n    var segment = brackets.exec(key);\n    var parent = segment ? key.slice(0, segment.index) : key;\n\n    // Stash the parent if it exists\n\n    var keys = [];\n    if (parent) {\n        // If we aren't using plain objects, optionally prefix keys\n        // that would overwrite object prototype properties\n        if (!options.plainObjects && has.call(Object.prototype, parent)) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n\n        keys.push(parent);\n    }\n\n    // Loop through children appending to the array until we hit depth\n\n    var i = 0;\n    while ((segment = child.exec(key)) !== null && i < options.depth) {\n        i += 1;\n        if (!options.plainObjects && has.call(Object.prototype, segment[1].slice(1, -1))) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n        keys.push(segment[1]);\n    }\n\n    // If there's a remainder, just add whatever is left\n\n    if (segment) {\n        keys.push('[' + key.slice(segment.index) + ']');\n    }\n\n    return parseObject(keys, val, options);\n};\n\nmodule.exports = function (str, opts) {\n    var options = opts ? utils.assign({}, opts) : {};\n\n    if (options.decoder !== null && options.decoder !== undefined && typeof options.decoder !== 'function') {\n        throw new TypeError('Decoder has to be a function.');\n    }\n\n    options.ignoreQueryPrefix = options.ignoreQueryPrefix === true;\n    options.delimiter = typeof options.delimiter === 'string' || utils.isRegExp(options.delimiter) ? options.delimiter : defaults.delimiter;\n    options.depth = typeof options.depth === 'number' ? options.depth : defaults.depth;\n    options.arrayLimit = typeof options.arrayLimit === 'number' ? options.arrayLimit : defaults.arrayLimit;\n    options.parseArrays = options.parseArrays !== false;\n    options.decoder = typeof options.decoder === 'function' ? options.decoder : defaults.decoder;\n    options.allowDots = typeof options.allowDots === 'boolean' ? options.allowDots : defaults.allowDots;\n    options.plainObjects = typeof options.plainObjects === 'boolean' ? options.plainObjects : defaults.plainObjects;\n    options.allowPrototypes = typeof options.allowPrototypes === 'boolean' ? options.allowPrototypes : defaults.allowPrototypes;\n    options.parameterLimit = typeof options.parameterLimit === 'number' ? options.parameterLimit : defaults.parameterLimit;\n    options.strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : defaults.strictNullHandling;\n\n    if (str === '' || str === null || typeof str === 'undefined') {\n        return options.plainObjects ? Object.create(null) : {};\n    }\n\n    var tempObj = typeof str === 'string' ? parseValues(str, options) : str;\n    var obj = options.plainObjects ? Object.create(null) : {};\n\n    // Iterate over the keys and setup the new object\n\n    var keys = Object.keys(tempObj);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var newObj = parseKeys(key, tempObj[key], options);\n        obj = utils.merge(obj, newObj, options);\n    }\n\n    return utils.compact(obj);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar formats = require('./formats');\n\nvar arrayPrefixGenerators = {\n    brackets: function brackets(prefix) { // eslint-disable-line func-name-matching\n        return prefix + '[]';\n    },\n    indices: function indices(prefix, key) { // eslint-disable-line func-name-matching\n        return prefix + '[' + key + ']';\n    },\n    repeat: function repeat(prefix) { // eslint-disable-line func-name-matching\n        return prefix;\n    }\n};\n\nvar toISO = Date.prototype.toISOString;\n\nvar defaults = {\n    delimiter: '&',\n    encode: true,\n    encoder: utils.encode,\n    encodeValuesOnly: false,\n    serializeDate: function serializeDate(date) { // eslint-disable-line func-name-matching\n        return toISO.call(date);\n    },\n    skipNulls: false,\n    strictNullHandling: false\n};\n\nvar stringify = function stringify( // eslint-disable-line func-name-matching\n    object,\n    prefix,\n    generateArrayPrefix,\n    strictNullHandling,\n    skipNulls,\n    encoder,\n    filter,\n    sort,\n    allowDots,\n    serializeDate,\n    formatter,\n    encodeValuesOnly\n) {\n    var obj = object;\n    if (typeof filter === 'function') {\n        obj = filter(prefix, obj);\n    } else if (obj instanceof Date) {\n        obj = serializeDate(obj);\n    } else if (obj === null) {\n        if (strictNullHandling) {\n            return encoder && !encodeValuesOnly ? encoder(prefix, defaults.encoder) : prefix;\n        }\n\n        obj = '';\n    }\n\n    if (typeof obj === 'string' || typeof obj === 'number' || typeof obj === 'boolean' || utils.isBuffer(obj)) {\n        if (encoder) {\n            var keyValue = encodeValuesOnly ? prefix : encoder(prefix, defaults.encoder);\n            return [formatter(keyValue) + '=' + formatter(encoder(obj, defaults.encoder))];\n        }\n        return [formatter(prefix) + '=' + formatter(String(obj))];\n    }\n\n    var values = [];\n\n    if (typeof obj === 'undefined') {\n        return values;\n    }\n\n    var objKeys;\n    if (Array.isArray(filter)) {\n        objKeys = filter;\n    } else {\n        var keys = Object.keys(obj);\n        objKeys = sort ? keys.sort(sort) : keys;\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (skipNulls && obj[key] === null) {\n            continue;\n        }\n\n        if (Array.isArray(obj)) {\n            values = values.concat(stringify(\n                obj[key],\n                generateArrayPrefix(prefix, key),\n                generateArrayPrefix,\n                strictNullHandling,\n                skipNulls,\n                encoder,\n                filter,\n                sort,\n                allowDots,\n                serializeDate,\n                formatter,\n                encodeValuesOnly\n            ));\n        } else {\n            values = values.concat(stringify(\n                obj[key],\n                prefix + (allowDots ? '.' + key : '[' + key + ']'),\n                generateArrayPrefix,\n                strictNullHandling,\n                skipNulls,\n                encoder,\n                filter,\n                sort,\n                allowDots,\n                serializeDate,\n                formatter,\n                encodeValuesOnly\n            ));\n        }\n    }\n\n    return values;\n};\n\nmodule.exports = function (object, opts) {\n    var obj = object;\n    var options = opts ? utils.assign({}, opts) : {};\n\n    if (options.encoder !== null && options.encoder !== undefined && typeof options.encoder !== 'function') {\n        throw new TypeError('Encoder has to be a function.');\n    }\n\n    var delimiter = typeof options.delimiter === 'undefined' ? defaults.delimiter : options.delimiter;\n    var strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : defaults.strictNullHandling;\n    var skipNulls = typeof options.skipNulls === 'boolean' ? options.skipNulls : defaults.skipNulls;\n    var encode = typeof options.encode === 'boolean' ? options.encode : defaults.encode;\n    var encoder = typeof options.encoder === 'function' ? options.encoder : defaults.encoder;\n    var sort = typeof options.sort === 'function' ? options.sort : null;\n    var allowDots = typeof options.allowDots === 'undefined' ? false : options.allowDots;\n    var serializeDate = typeof options.serializeDate === 'function' ? options.serializeDate : defaults.serializeDate;\n    var encodeValuesOnly = typeof options.encodeValuesOnly === 'boolean' ? options.encodeValuesOnly : defaults.encodeValuesOnly;\n    if (typeof options.format === 'undefined') {\n        options.format = formats['default'];\n    } else if (!Object.prototype.hasOwnProperty.call(formats.formatters, options.format)) {\n        throw new TypeError('Unknown format option provided.');\n    }\n    var formatter = formats.formatters[options.format];\n    var objKeys;\n    var filter;\n\n    if (typeof options.filter === 'function') {\n        filter = options.filter;\n        obj = filter('', obj);\n    } else if (Array.isArray(options.filter)) {\n        filter = options.filter;\n        objKeys = filter;\n    }\n\n    var keys = [];\n\n    if (typeof obj !== 'object' || obj === null) {\n        return '';\n    }\n\n    var arrayFormat;\n    if (options.arrayFormat in arrayPrefixGenerators) {\n        arrayFormat = options.arrayFormat;\n    } else if ('indices' in options) {\n        arrayFormat = options.indices ? 'indices' : 'repeat';\n    } else {\n        arrayFormat = 'indices';\n    }\n\n    var generateArrayPrefix = arrayPrefixGenerators[arrayFormat];\n\n    if (!objKeys) {\n        objKeys = Object.keys(obj);\n    }\n\n    if (sort) {\n        objKeys.sort(sort);\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (skipNulls && obj[key] === null) {\n            continue;\n        }\n\n        keys = keys.concat(stringify(\n            obj[key],\n            key,\n            generateArrayPrefix,\n            strictNullHandling,\n            skipNulls,\n            encode ? encoder : null,\n            filter,\n            sort,\n            allowDots,\n            serializeDate,\n            formatter,\n            encodeValuesOnly\n        ));\n    }\n\n    var joined = keys.join(delimiter);\n    var prefix = options.addQueryPrefix === true ? '?' : '';\n\n    return joined.length > 0 ? prefix + joined : '';\n};\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty;\n\nvar hexTable = (function () {\n    var array = [];\n    for (var i = 0; i < 256; ++i) {\n        array.push('%' + ((i < 16 ? '0' : '') + i.toString(16)).toUpperCase());\n    }\n\n    return array;\n}());\n\nvar compactQueue = function compactQueue(queue) {\n    var obj;\n\n    while (queue.length) {\n        var item = queue.pop();\n        obj = item.obj[item.prop];\n\n        if (Array.isArray(obj)) {\n            var compacted = [];\n\n            for (var j = 0; j < obj.length; ++j) {\n                if (typeof obj[j] !== 'undefined') {\n                    compacted.push(obj[j]);\n                }\n            }\n\n            item.obj[item.prop] = compacted;\n        }\n    }\n\n    return obj;\n};\n\nvar arrayToObject = function arrayToObject(source, options) {\n    var obj = options && options.plainObjects ? Object.create(null) : {};\n    for (var i = 0; i < source.length; ++i) {\n        if (typeof source[i] !== 'undefined') {\n            obj[i] = source[i];\n        }\n    }\n\n    return obj;\n};\n\nvar merge = function merge(target, source, options) {\n    if (!source) {\n        return target;\n    }\n\n    if (typeof source !== 'object') {\n        if (Array.isArray(target)) {\n            target.push(source);\n        } else if (typeof target === 'object') {\n            if (options.plainObjects || options.allowPrototypes || !has.call(Object.prototype, source)) {\n                target[source] = true;\n            }\n        } else {\n            return [target, source];\n        }\n\n        return target;\n    }\n\n    if (typeof target !== 'object') {\n        return [target].concat(source);\n    }\n\n    var mergeTarget = target;\n    if (Array.isArray(target) && !Array.isArray(source)) {\n        mergeTarget = arrayToObject(target, options);\n    }\n\n    if (Array.isArray(target) && Array.isArray(source)) {\n        source.forEach(function (item, i) {\n            if (has.call(target, i)) {\n                if (target[i] && typeof target[i] === 'object') {\n                    target[i] = merge(target[i], item, options);\n                } else {\n                    target.push(item);\n                }\n            } else {\n                target[i] = item;\n            }\n        });\n        return target;\n    }\n\n    return Object.keys(source).reduce(function (acc, key) {\n        var value = source[key];\n\n        if (has.call(acc, key)) {\n            acc[key] = merge(acc[key], value, options);\n        } else {\n            acc[key] = value;\n        }\n        return acc;\n    }, mergeTarget);\n};\n\nvar assign = function assignSingleSource(target, source) {\n    return Object.keys(source).reduce(function (acc, key) {\n        acc[key] = source[key];\n        return acc;\n    }, target);\n};\n\nvar decode = function (str) {\n    try {\n        return decodeURIComponent(str.replace(/\\+/g, ' '));\n    } catch (e) {\n        return str;\n    }\n};\n\nvar encode = function encode(str) {\n    // This code was originally written by Brian White (mscdex) for the io.js core querystring library.\n    // It has been adapted here for stricter adherence to RFC 3986\n    if (str.length === 0) {\n        return str;\n    }\n\n    var string = typeof str === 'string' ? str : String(str);\n\n    var out = '';\n    for (var i = 0; i < string.length; ++i) {\n        var c = string.charCodeAt(i);\n\n        if (\n            c === 0x2D // -\n            || c === 0x2E // .\n            || c === 0x5F // _\n            || c === 0x7E // ~\n            || (c >= 0x30 && c <= 0x39) // 0-9\n            || (c >= 0x41 && c <= 0x5A) // a-z\n            || (c >= 0x61 && c <= 0x7A) // A-Z\n        ) {\n            out += string.charAt(i);\n            continue;\n        }\n\n        if (c < 0x80) {\n            out = out + hexTable[c];\n            continue;\n        }\n\n        if (c < 0x800) {\n            out = out + (hexTable[0xC0 | (c >> 6)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        if (c < 0xD800 || c >= 0xE000) {\n            out = out + (hexTable[0xE0 | (c >> 12)] + hexTable[0x80 | ((c >> 6) & 0x3F)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        i += 1;\n        c = 0x10000 + (((c & 0x3FF) << 10) | (string.charCodeAt(i) & 0x3FF));\n        out += hexTable[0xF0 | (c >> 18)]\n            + hexTable[0x80 | ((c >> 12) & 0x3F)]\n            + hexTable[0x80 | ((c >> 6) & 0x3F)]\n            + hexTable[0x80 | (c & 0x3F)];\n    }\n\n    return out;\n};\n\nvar compact = function compact(value) {\n    var queue = [{ obj: { o: value }, prop: 'o' }];\n    var refs = [];\n\n    for (var i = 0; i < queue.length; ++i) {\n        var item = queue[i];\n        var obj = item.obj[item.prop];\n\n        var keys = Object.keys(obj);\n        for (var j = 0; j < keys.length; ++j) {\n            var key = keys[j];\n            var val = obj[key];\n            if (typeof val === 'object' && val !== null && refs.indexOf(val) === -1) {\n                queue.push({ obj: obj, prop: key });\n                refs.push(val);\n            }\n        }\n    }\n\n    return compactQueue(queue);\n};\n\nvar isRegExp = function isRegExp(obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n};\n\nvar isBuffer = function isBuffer(obj) {\n    if (obj === null || typeof obj === 'undefined') {\n        return false;\n    }\n\n    return !!(obj.constructor && obj.constructor.isBuffer && obj.constructor.isBuffer(obj));\n};\n\nmodule.exports = {\n    arrayToObject: arrayToObject,\n    assign: assign,\n    compact: compact,\n    decode: decode,\n    encode: encode,\n    isBuffer: isBuffer,\n    isRegExp: isRegExp,\n    merge: merge\n};\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","/**\n * External dependencies.\n */\nimport serialize from 'form-serialize';\n\n/**\n * Internal dependencies.\n */\nimport { apiRequest } from '@wpsimplepay/utils';\n\n/**\n * Create a Customer object based on current formData.\n *\n * @param {Object} data Data to pass to REST endpoint.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n * @return {Promise} AJAX promise.\n */\nexport function create( data = {}, spFormElem, formData ) {\n\treturn apiRequest( 'v2/customer', {\n\t\tform_values: serialize( spFormElem[ 0 ], { hash: true } ),\n\t\tform_data: formData,\n\t\tform_id: formData.formId,\n\t\t...data,\n\t} );\n}\n","/**\n * Internal dependencies\n */\nimport LineItem from './line-item.js';\n\n/**\n * Cart\n */\nexport const Cart = class Cart {\n\t/**\n\t * Creates a cart.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @see `update()`\n\t *\n\t * @param {Object} args Cart arguments.\n\t * @return {Cart} Cart.\n\t */\n\tconstructor( args ) {\n\t\t// Set defaults.\n\t\t// @todo add support for classProperties.\n\t\tthis.items = [];\n\t\tthis.currency = 'usd';\n\t\tthis.taxPercent = 0;\n\t\tthis.coupon = false;\n\t\tthis.isNonDecimalCurrency = false;\n\n\t\tthis.update( args );\n\t}\n\n\t/**\n\t * Updates the cart.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @param {Object} args Cart arguments.\n\t * @param {number} args.taxPercent Tax percentage.\n\t * @param {false|Object} args.coupon Stripe Coupon.\n\t * @param {boolean} args.isNonDecimalCurrency If the currency is non-decimal based.\n\t * @return {Cart} Cart.\n\t */\n\tupdate( args ) {\n\t\t// Parse and retrieve specific arguments.\n\t\tconst {\n\t\t\tcurrency,\n\t\t\ttaxPercent,\n\t\t\tcoupon,\n\t\t\tisNonDecimalCurrency,\n\t\t} = {\n\t\t\t...this,\n\t\t\t...args,\n\t\t};\n\n\t\t// Set currency.\n\t\tif ( 'string' !== typeof currency ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-currency',\n\t\t\t\tmessage: 'Currency must be a string.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.currency = currency;\n\t\t}\n\n\t\t// Set fees.\n\t\tif ( isNaN( taxPercent ) ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-tax-percent',\n\t\t\t\tmessage: 'Tax percentage must be a number.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.taxPercent = parseFloat( taxPercent );\n\t\t}\n\n\t\t// Set coupon.\n\t\t// @todo Validate coupon data.\n\t\tif ( ! ( false === coupon || 'object' === typeof coupon ) ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-coupon',\n\t\t\t\tmessage: 'Coupon must be a false or contain coupon data.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.coupon = coupon;\n\t\t}\n\n\t\tif ( 'boolean' !== typeof isNonDecimalCurrency  ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-non-decimal-currency',\n\t\t\t\tmessage: 'Declaring a non-decimal currency must be a boolean.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.isNonDecimalCurrency = isNonDecimalCurrency;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Resets the cart.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {Cart} Cart.\n\t */\n\treset() {\n\t\treturn new Cart;\n\t}\n\n\t/**\n\t * Retrieves coupon information.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {Object} Stripe Coupon.\n\t */\n\tgetCoupon() {\n\t\treturn this.coupon;\n\t}\n\n\t/**\n\t * Retrieves the cart's tax percent amount.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number}\n\t */\n\tgetTaxPercent() {\n\t\treturn this.taxPercent;\n\t}\n\n\t/**\n\t * Retrieves the cart's tax decimal amount for calculations.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number}\n\t */\n\tgetTaxDecimal() {\n\t\treturn ( this.taxPercent / 100 );\n\t}\n\n\t/**\n\t * Retrieves the items in the cart.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {Array} List of cart items.\n\t */\n\tgetLineItems() {\n\t\treturn this.items;\n\t}\n\n\t/**\n\t * Retrieves an item.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @param {string} id Cart line item ID.\n\t * @return {LineItem} Cart line item.\n\t */\n\tgetLineItem( id ) {\n\t\tconst items = this.getLineItems();\n\n\t\t// Can't use `find` because it is not supported in IE.\n\t\tconst filteredItems = items.filter( ( { id: itemId } ) => ( itemId === id ) );\n\n\t\tif ( 0 === filteredItems.length ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-line-item',\n\t\t\t\tmessage: `Unable to retrieve line item \"${ id }\"`,\n\t\t\t};\n\t\t}\n\n\t\treturn filteredItems[ 0 ];\n\t}\n\n\t/**\n\t * Adds a line item to the cart.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @param {Object|LineItem} item Cart line item or arguments to create one.\n\t * @return {LineItem} Added line item.\n\t */\n\taddLineItem( item ) {\n\t\tlet lineitem;\n\n\t\tif ( true === item instanceof LineItem ) {\n\t\t\tlineitem = item;\n\t\t} else {\n\t\t\tlineitem = new this.LineItem( item, this );\n\t\t}\n\n\t\tthis.items.push( lineitem );\n\n\t\treturn lineitem;\n\t}\n};\n","export * from './cart.js';\nexport * from './line-item.js';\n\n/**\n * Converts current `formData` to a structured cart.\n *\n * @since 3.7.0\n *\n * @param {Object} formData Legacy form data.\n * @return {Object} data Cart data.\n */\nexport function convertFormDataToCartData( formData ) {\n\tconst {\n\t\tdebugLog,\n\t\tconvertToCents,\n\t} = window.spShared;\n\n\tconst {\n\t\tbooleans: {\n\t\t\tisZeroDecimal: isNonDecimalCurrency,\n\t\t},\n\t} = window.spGeneral;\n\n\tconst {\n\t\tstripeParams: {\n\t\t\tcurrency,\n\t\t},\n\n\t\t// Items.\n\t\tamount,\n\t\tisSubscription,\n\t\tquantity,\n\t\tisTrial,\n\t\tplanInterval,\n\t\tplanIntervalCount,\n\n\t\t// Fees.\n\t\tfeePercent,\n\t\tfeeAmount,\n\t\ttaxPercent,\n\t\tsetupFee,\n\t} = formData;\n\n\tconst data = {\n\t\tcurrency,\n\t\titems: [],\n\t\ttaxPercent: 0,\n\t\tisNonDecimalCurrency,\n\t};\n\n\t//\n\t// Add items.\n\t//\n\n\t// Initial Setup Fee.\n\tif ( ! isNaN( setupFee ) ) {\n\t\tdata.items.push( {\n\t\t\tid: 'setup-fee',\n\t\t\ttitle: 'Initial Setup Fee',\n\t\t\tamount: convertToCents( setupFee ),\n\t\t\tquantity: 1,\n\t\t\tsubscription: false,\n\t\t} );\n\t}\n\n\t// Plan Setup Fee.\n\tdata.items.push( {\n\t\tid: 'plan-setup-fee',\n\t\ttitle: 'Plan Setup Fee',\n\t\tamount: 0,\n\t\tquantity: 1,\n\t\tsubscription: false,\n\t} );\n\n\t// Base item.\n\tif ( isSubscription ) {\n\t\tdata.items.push( {\n\t\t\tid: 'base',\n\t\t\ttitle: 'Subscription',\n\t\t\tamount: convertToCents( amount ),\n\t\t\tquantity,\n\t\t\tsubscription: {\n\t\t\t\tisTrial,\n\t\t\t\tinterval: planInterval,\n\t\t\t\tintervalCount: planIntervalCount,\n\t\t\t},\n\t\t} );\n\t} else {\n\t\tlet singleAmount = amount;\n\n\t\tif ( ! isNaN( feeAmount ) && feeAmount > 0 ) {\n\t\t\tsingleAmount += feeAmount;\n\n\t\t\tdebugLog( 'feeAmount:', 'Arbitrary fee amounts should be added to the base amount directly.' );\n\t\t}\n\n\t\tdata.items.push( {\n\t\t\tid: 'base',\n\t\t\ttitle: 'One-time amount',\n\t\t\tamount: convertToCents( singleAmount ),\n\t\t\tquantity,\n\t\t\tsubscription: false,\n\t\t} );\n\t}\n\n\t// Tax.\n\tif ( ! isNaN( taxPercent ) ) {\n\t\tdata.taxPercent = taxPercent;\n\t}\n\n\t// Add any arbitrary fee percentage to tax percentage.\n\t// @link https://github.com/wpsimplepay/wp-simple-pay-pro/issues/1161\n\tif ( ! isNaN( feePercent ) && feePercent > 0 ) {\n\t\tdata.taxPercent = data.taxPercent + feePercent;\n\t\tdebugLog( 'feePercent:', 'Arbitrary fee percentages should be added to the taxPercent directly.' );\n\t};\n\n\treturn data;\n}\n","/**\n * Internal dependencies\n */\nimport { Cart } from './cart.js';\n\n/**\n * LineItem\n */\nexport const LineItem = class LineItem {\n\t/**\n\t * Create a line item.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @param {Object} args Line item arguments.\n\t * @param {string} args.id Cart line item ID.\n\t * @param {string} args.title Cart line item title.\n\t * @param {number} args.amount Cart line item amount.\n\t * @param {number} args.quantity Cart line item quantity.\n\t * @param {boolean|Object} args.subscription Cart line item subscription data.\n\t * @param {boolean} args.subscription.isTrial Cart line item subscription trial designation.\n\t * @param {number} args.subscription.intervalCount Cart line item subscription interval count.\n\t * @param {number} args.subscription.interval Cart line item subscription interval.\n\t * @param {Cart} cart Cart this line item is attached to.\n\t * @return {LineItem} LineItem\n\t */\n\tconstructor( args, cart ) {\n\t\t// Set defaults.\n\t\t// @todo add support for classProperties.\n\t\tthis.cart = null;\n\t\tthis.id = null;\n\t\tthis.title = null;\n\t\tthis.amount = 0;\n\t\tthis.quantity = 1;\n\t\tthis.subscription = false;\n\n\t\tif ( 'object' !== typeof cart ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-line-item-cart',\n\t\t\t\tmessage: 'Item must have an cart.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.cart = cart;\n\t\t}\n\n\t\tthis.update( args );\n\t}\n\n\t/**\n\t * Updates a line item.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @param {Object} args Cart line item arguments.\n\t * @param {string} args.id Cart line item ID.\n\t * @param {string} args.title Cart line item title.\n\t * @param {number} args.amount Cart line item amount.\n\t * @param {number} args.quantity Cart line item quantity.\n\t * @param {boolean|Object} args.subscription Cart line item subscription data.\n\t * @param {boolean} args.subscription.isTrial Cart line item subscription trial designation.\n\t * @param {number} args.subscription.intervalCount Cart line item subscription interval count.\n\t * @param {number} args.subscription.interval Cart line item subscription interval.\n\t * @return {LineItem} Line item.\n\t */\n\tupdate( args ) {\n\t\t// Parse and retrieve specific arguments.\n\t\tconst {\n\t\t\tid,\n\t\t\ttitle,\n\t\t\tamount,\n\t\t\tquantity,\n\t\t\tsubscription,\n\t\t} = {\n\t\t\t...this,\n\t\t\t...args,\n\t\t};\n\n\t\t// ID must be a string.\n\t\tif ( 'string' !== typeof id ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-line-item-id',\n\t\t\t\tmessage: 'Item ID must be a string.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.id = id;\n\t\t}\n\n\t\t// Title must be a string.\n\t\t// Not currently shown in any UI, but may be in the future.\n\t\tif ( 'string' !== typeof title ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-line-item-title',\n\t\t\t\tmessage: 'Item title must be a string.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.title = title;\n\t\t}\n\n\t\t// Amount must be a number.\n\t\tif ( ! Number.isSafeInteger( amount ) ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-line-item-amount',\n\t\t\t\tmessage: 'Item amount must be an integer.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.amount = amount;\n\t\t}\n\n\t\t// Quantity must be a number.\n\t\tif ( ! Number.isSafeInteger( quantity ) ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-line-item-quantity',\n\t\t\t\tmessage: 'Item quantity must be an integer.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.quantity = quantity;\n\t\t}\n\n\t\t// Subscription must be false or contain subscription data.\n\t\t// @todo Validate subscription data.\n\t\tif ( ! ( false === subscription || 'object' === typeof subscription ) ) {\n\t\t\tthrow {\n\t\t\t\tid: 'invalid-line-item-subscription',\n\t\t\t\tmessage: 'Item subscription data must be a false or contain subscription data.',\n\t\t\t};\n\t\t} else {\n\t\t\tthis.subscription = subscription;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Removes the line item from the cart.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {LineItem} Removed line item.\n\t */\n\tremove() {\n\t\tconst allItems = this.cart.getLineItems();\n\t\tconst remainingItems = allItems.filter( ( { id } ) => ( this.id !== id ) );\n\n\t\tthis.cart.items = remainingItems;\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Retrieves a cart line item's unit price.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number} Cart line item unit price.\n\t */\n\tgetUnitPrice() {\n\t\treturn this.amount;\n\t}\n\n\t/**\n\t * Retrieves the cart line item's quantity.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number} Cart line item quantity.\n\t */\n\tgetQuantity() {\n\t\treturn this.quantity;\n\t}\n\t\n\t/**\n\t * Retrieves a cart line item's tax.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number} Cart line item tax.\n\t */\n\tgetTax() {\n\t\tlet tax = 0;\n\t\tlet i = 0;\n\n\t\tconst taxDecimal = this.cart.getTaxDecimal();\n\t\tconst quantity = this.getQuantity();\n\t\tconst subtotal = this.getSubtotal();\n\n\t\tfor ( i = 0; i < quantity; i++ ) {\n\t\t\ttax += Math.round( subtotal * taxDecimal );\n\t\t}\n\n\t\treturn tax;\n\t}\n};\n\nexport default LineItem;\n","/* global jQuery, wpApiSettings */\n\n/**\n * Make an API request to the REST API.\n *\n * @param {string} route REST route.\n * @param {Object} data Data to send to the request.\n * @return {Promise} jQuery promise.\n */\nexport function apiRequest( route, data ) {\n\treturn jQuery.ajax( {\n\t\tdata,\n\t\tmethod: 'POST',\n\t\turl: `${ wpApiSettings.root }wpsp/${ route }`,\n\t\tbeforeSend: ( xhr ) => {\n\t\t\txhr.setRequestHeader( 'X-WP-Nonce', wpApiSettings.nonce );\n\t\t},\n\t} );\n}\n","export * from './number.js';\nexport * from './api-request.js';\n","// @link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger#Polyfill\nNumber.isInteger = Number.isInteger || function( value ) {\n\treturn typeof value === 'number' &&\n\t\tisFinite( value ) &&\n\t\tMath.floor( value ) === value;\n};\n\n// @link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isSafeInteger#Polyfill\nNumber.isSafeInteger = Number.isSafeInteger || function( value ) {\n\treturn Number.isInteger( value ) && Math.abs( value ) <= Number.MAX_SAFE_INTEGER;\n};\n\n// @link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER#Polyfill\nif ( ! Number.MAX_SAFE_INTEGER ) {\n\tNumber.MAX_SAFE_INTEGER = 9007199254740991; // Math.pow(2, 53) - 1;\n}\n","/* globals _ */\n\n/**\n * Internal dependencies.\n */\nimport { setup as setupDateField } from './components/date.js';\nimport { apply as applyCoupon, remove as removeCoupon } from './components/coupon.js';\nimport { update as updateAmountField } from './components/amount.js';\nimport { update as updateQuantiyField } from './components/quantity.js';\nimport { update as updateTotalAmountLabels } from './components/total-amount-labels.js';\nimport { update as updateMultiSubSelection } from './components/multi-sub.js';\nimport { toggleShippingAddressFields } from './components/address.js';\nimport { toggle as toggleOverlayForm } from './payment-forms/stripe-elements/overlays.js';\nimport {\n\tupdate as updateCustomAmount,\n\tenableCustomPlanAmount\n} from './components/custom-amount.js';\nimport { \n\tsetup as enablePaymentRequestButton,\n\tupdate as updatePaymentRequestButton,\n\tgetDisplayItems as getPaymentRequestDisplayItems,\n\tpaymentRequestIsValid\n} from './components/payment-request-button.js';\n\nconst doNothingFuncs = [\n\t'setupStripeElementsForm',\n\t'createCard',\n\t'getCardConfig',\n\t'handleCardFocus',\n\t'focusFirstField',\n\t'beforeSubmitPayment',\n];\n\n/**\n * Shim object properties for backwards compatibility.\n *\n * Some of these will do nothing, but it will help diagnose\n * issues for customers who have improperly referenced them in the past.\n */\nexport default _.extend(\n\t_.reduce( doNothingFuncs, ( memo, func ) => {\n\t\tmemo[ func ] = ( func ) => {\n\t\t\treturn window.spShared.debugLog( 'Deprecated:', `${ func } is no longer used.` );\n\t\t};\n\n\t\treturn memo;\n\t}, {} ),\n\t{\n\t\tisCustomAmountFieldValid: ( spFormElem, formData ) => {\n\t\t\treturn updateCustomAmount( null, spFormElem, formData );\n\t\t},\n\n\t\tinitDateField: ( spFormElem ) => {\n\t\t\treturn setupDateField( null, spFormElem, null );\n\t\t},\n\n\t\thandleCustomAmountFocusIn: ( spFormElem, formData ) => {\n\t\t\treturn enableCustomPlanAmount( null, spFormElem, formData );\n\t\t},\n\n\t\tprocessCustomAmount: ( spFormElem, formData ) => {\n\t\t\treturn updateCustomAmount( null, spFormElem, formData );\n\t\t},\n\n\t\tupdateAmountSelect: ( spFormElem, formData ) => {\n\t\t\treturn updateAmountField( null, spFormElem, formData );\n\t\t},\n\n\t\tupdateQuantitySelect: ( spFormElem, formData ) => {\n\t\t\treturn updateQuantityField( null, spFormElem, formData );\n\t\t},\n\n\t\tupdateTotalAmountLabel: ( spFormElem, formData ) => {\n\t\t\treturn updateTotalAmountLabels( null, spFormElem, formData );\n\t\t},\n\n\t\tupdateRecurringAmountLabel: ( spFormElem, formData ) => {\n\t\t\treturn updateTotalAmountLabels( null, spFormElem, formData );\n\t\t},\n\n\t\tupdateTaxAmountLabel: ( spFormElem, formData ) => {\n\t\t\treturn updateTotalAmountLabels( null, spFormElem, formData );\n\t\t},\n\n\t\tchangeMultiSubAmount: ( spFormElem, formData ) => {\n\t\t\treturn updateMultiSubSelection( null, spFormElem, formData );\n\t\t},\n\n\t\tenablePaymentRequestButton: ( spFormElem, formData ) => {\n\t\t\treturn enablePaymentRequestButton( null, spFormElem, formData );\n\t\t},\n\n\t\tbindProFormEventsAndTriggers: ( e, spFormElem, formData ) => {\n\t\t\treturn window.simpayAppPro.bindEvents( e, spFormElem, formData );\n\t\t},\n\n\t\thandleFieldFocus: ( spFormElem ) => {\n\t\t\treturn window.simpayAppPro.setOnFieldFocus( spFormElem );\n\t\t},\n\n\t\tenableForm: ( spFormElem, formData ) => {\n\t\t\treturn window.simpayApp.enableForm( spFormElem, formData );\n\t\t},\n\n\t\tdisableForm: ( spFormElem, formData, setSubmitButtonAsLoading = false ) => {\n\t\t\treturn window.simpayApp.disableForm( spFormElem, formData, setSubmitButtonAsLoading );\n\t\t},\n\n\t\ttriggerBrowserValidation: ( spFormElem, formData ) => {\n\t\t\treturn window.simpayApp.triggerBrowserValidation( spFormElem, formData );\n\t\t},\n\n\t\tsetProFinalAmount: ( e, spFormElem, formData ) => {\n\t\t\treturn window.simpayAppPro.updateAmounts( e, spFormElem, formData );\n\t\t},\n\n\t\t/**\n\t\t * Calculate the amount of tax given an amount and percentage.\n\t\t *\n\t\t * @since 3.0\n\t\t * @since 3.7.0 Deprecated.\n\t\t *\n\t\t * @param {number} amount Base amount.\n\t\t * @param {number} percent Tax percent.\n\t\t */\n\t\tcalculateTaxAmount( amount, percent ) {\n\t\t\tconst {\n\t\t\t\tdebugLog,\n\t\t\t} = window.spShared;\n\n\t\t\tdebugLog( 'calculateTaxAmount', 'Use spFormElem.cart to access cart tax calculations' );\n\n\t\t\treturn Math.abs( accounting.toFixed( amount * ( percent / 100 ), window.spGeneral.integers.decimalPlaces ) );\n\t\t},\n\n\t\tupdatePaymentRequestButton,\n\t\tpaymentRequestIsValid,\n\t\tgetPaymentRequestDisplayItems,\n\t\ttoggleShippingAddressFields,\n\t\tapplyCoupon,\n\t\tremoveCoupon,\n\t\ttoggleOverlayForm,\n\t}\n);\n","/**\n * Toggle shipping address fields.\n *\n * When hiding, disable fields so the values are not sent.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function toggleShippingAddressFields( spFormElem, formData ) {\n\tconst shippingAddressContainer = spFormElem.find( '.simpay-shipping-address-container' );\n\tconst isChecked = spFormElem.find( '.simpay-same-address-toggle' ).is( ':checked' );\n\n\tshippingAddressContainer\n\t\t.toggle()\n\t\t.find( 'input, select' )\n\t\t.prop( 'disabled', isChecked );\n}\n","/**\n * Update the form amount based on \"Amount\" field selected value.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function update( e, spFormElem, formData ) {\n\tlet amount;\n\n\tconst {\n\t\tconvertToCents,\n\t} = window.spShared;\n\n\t// Update the amount to the selected dropdown amount\n\tif ( 0 !== spFormElem.find( '.simpay-amount-dropdown' ).length ) {\n\t\tamount = spFormElem.find( '.simpay-amount-dropdown' ).find( 'option:selected' ).data( 'amount' );\n\n\t\tspFormElem.trigger( 'simpayDropdownAmountChange' );\n\t// Update the amount to the selected radio button\n\t} else if ( 0 !== spFormElem.find( '.simpay-amount-radio' ).length ) {\n\t\tamount = spFormElem.find( '.simpay-amount-radio' ).find( 'input[type=\"radio\"]:checked' ).data( 'amount' );\n\n\t\tspFormElem.trigger( 'simpayRadioAmountChange' );\n\t}\n\n\tif ( amount > 0 ) {\n\t\ttry {\n\t\t\tconst item = spFormElem.cart.getLineItem( 'base' );\n\n\t\t\titem.update( {\n\t\t\t\tamount: convertToCents( amount ),\n\t\t\t} );\n\n\t\t\t// Backwards compatibility.\n\t\t\tformData.amount = amount;\n\n\t\t\t// Alert the rest of the components they need to update.\n\t\t\tspFormElem.trigger( 'totalChanged', [ spFormElem, formData ] );\n\t\t} catch ( error ) {\n\t\t\t// Error is logged, UI does not need updating.\n\t\t}\n\t}\n}\n","/* global jQuery */\n\n/**\n * Internal dependencies.\n */\nimport { update as updateTotalAmountLabels } from './total-amount-labels.js';\n\n/**\n * Apply a coupon.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function apply( spFormElem, formData ) {\n\tconst $ = jQuery;\n\tconst couponField = spFormElem.find( '.simpay-coupon-field' );\n\tconst responseContainer = spFormElem.find( '.simpay-coupon-message' );\n\tconst loadingImage = spFormElem.find( '.simpay-coupon-loading' );\n\tconst removeCoupon = spFormElem.find( '.simpay-remove-coupon' );\n\tconst hiddenCouponElem = spFormElem.find( '.simpay-coupon' );\n\n\tconst {\n\t\tconvertToCents,\n\t\tdebugLog,\n\t} = window.spShared;\n\n\tlet coupon = '';\n\tlet couponMessage = '';\n\n\tif ( ! couponField.val() && ! formData.couponCode ) {\n\t\treturn;\n\t} else if ( formData.couponCode ) {\n\t\tcoupon = formData.couponCode;\n\t} else {\n\t\tcoupon = couponField.val();\n\t}\n\n\t// AJAX params\n\tconst data = {\n\t\tcoupon,\n\t\tamount: spFormElem.cart.getSubtotal(),\n\t\taction: 'simpay_get_coupon',\n\t\tform_id: formData.formId,\n\t\tcouponNonce: spFormElem.find( '#simpay_coupon_nonce' ).val(),\n\t};\n\n\t// Clear the response container and hide the remove coupon link\n\tresponseContainer.text( '' );\n\tremoveCoupon.hide();\n\n\t// Clear textbox\n\tcouponField.val( '' );\n\n\t// Show the loading image\n\tloadingImage.show();\n\n\t$.ajax( {\n\t\turl: window.spGeneral.strings.ajaxurl,\n\t\tmethod: 'POST',\n\t\tdata,\n\t\tdataType: 'json',\n\t\tsuccess( response ) {\n\t\t\tif ( response.success ) {\n\t\t\t\t// Backwards compatibility.\n\t\t\t\tformData.couponCode = coupon;\n\n\t\t\t\t// Backwards compatibility.\n\t\t\t\tformData.discount = response.discount;\n\n\t\t\t\t// Update the cart.\n\t\t\t\ttry {\n\t\t\t\t\tspFormElem.cart.update( {\n\t\t\t\t\t\tcoupon: response.stripeCoupon,\n\t\t\t\t\t} );\n\t\t\t\t} catch ( error ) {\n\t\t\t\t\tdebugLog( error );\n\t\t\t\t}\n\n\t\t\t\tconst {\n\t\t\t\t\tformatCurrency,\n\t\t\t\t} = window.spShared;\n\n\t\t\t\t// Coupon message for frontend\n\t\t\t\tcouponMessage = response.coupon.code + ': ';\n\n\t\t\t\t// Output different text based on the type of coupon it is - amount off or a percentage\n\t\t\t\tif ( 'percent' === response.coupon.type ) {\n\t\t\t\t\tcouponMessage += response.coupon.amountOff + spGeneral.i18n.couponPercentOffText;\n\t\t\t\t} else if ( 'amount' === response.coupon.type ) {\n\t\t\t\t\tcouponMessage += formatCurrency( response.coupon.amountOff, true ) + ' ' + spGeneral.i18n.couponAmountOffText;\n\t\t\t\t}\n\n\t\t\t\t$( '.coupon-details' ).remove();\n\n\t\t\t\t// Update the coupon message text\n\t\t\t\tresponseContainer\n\t\t\t\t\t.append( couponMessage )\n\t\t\t\t\t.show();\n\n\t\t\t\t// Create a hidden input to send our coupon details for Stripe metadata purposes\n\t\t\t\t$( '<input />', {\n\t\t\t\t\tname: 'simpay_coupon_details',\n\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\tvalue: couponMessage,\n\t\t\t\t\tclass: 'simpay-coupon-details',\n\t\t\t\t} ).appendTo( responseContainer );\n\n\t\t\t\t// Show remove coupon link\n\t\t\t\tremoveCoupon.show();\n\n\t\t\t\t// Add the coupon to our hidden element for processing\n\t\t\t\thiddenCouponElem.val( coupon );\n\n\t\t\t\t// Hide the loading image\n\t\t\t\tloadingImage.hide();\n\n\t\t\t\t// Trigger custom event when coupon apply done.\n\t\t\t\tspFormElem.trigger( 'simpayCouponApplied' );\n\t\t\t} else {\n\t\t\t\t// Show invalid coupon message\n\t\t\t\tresponseContainer\n\t\t\t\t\t.show()\n\t\t\t\t\t.append( $( '<p />' )\n\t\t\t\t\t\t.addClass( 'simpay-field-error' )\n\t\t\t\t\t\t.text( response.data.error ) );\n\n\t\t\t\t// Hide loading image\n\t\t\t\tloadingImage.hide();\n\t\t\t}\n\t\t},\n\t\terror( response ) {\n\t\t\tlet errorMessage = '';\n\n\t\t\tconst {\n\t\t\t\tdebugLog,\n\t\t\t} = window.spShared;\n\n\t\t\tdebugLog( 'Coupon error', response.responseText );\n\n\t\t\tif ( response.responseText ) {\n\t\t\t\terrorMessage = response.responseText;\n\t\t\t}\n\n\t\t\t// Show invalid coupon message\n\t\t\tresponseContainer\n\t\t\t\t.show()\n\t\t\t\t.append( $( '<p />' )\n\t\t\t\t\t.addClass( 'simpay-field-error' )\n\t\t\t\t\t.text( errorMessage ) );\n\n\t\t\t// Hide loading image\n\t\t\tloadingImage.hide();\n\t\t},\n\t\tcomplete( response ) {\n\t\t\t// Alert the rest of the components they need to update.\n\t\t\t// Tell main totalChanged handler not to do anything with coupons.\n\t\t\tspFormElem.trigger( 'totalChanged', [ spFormElem, formData, false ] );\n\t\t},\n\t} );\n}\n\n/**\n * Remove a coupon.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function remove( spFormElem, formData ) {\n\tconst {\n\t\tdebugLog,\n\t} = window.spShared;\n\n\ttry {\n\t\tspFormElem.cart.update( {\n\t\t\tcoupon: false,\n\t\t} );\n\n\t\t// Trigger custom event when coupon apply done.\n\t\tspFormElem.trigger( 'simpayCouponRemoved' );\n\n\t\t// Alert the rest of the components they need to update.\n\t\t// Tell main totalChanged handler not to do anything with coupons.\n\t\tspFormElem.trigger( 'totalChanged', [ spFormElem, formData, false ] );\n\t} catch ( error ) {\n\t\tdebugLog( error );\n\t}\n\n\t// Backwards compatibility.\n\tspFormElem.find( '.simpay-coupon-loading' ).hide();\n\tspFormElem.find( '.simpay-remove-coupon' ).hide();\n\tspFormElem.find( '.simpay-coupon-message' )\n\t\t.text( '' )\n\t\t.hide();\n\tspFormElem.find( '.simpay-coupon' ).val( '' );\n\n\tformData.couponCode = '';\n\tformData.discount = 0;\n}\n","/**\n * Internal dependencies.\n */\nimport { update as updateTotalAmountLabels } from './total-amount-labels.js';\n\n/**\n * @param {Event} e Focusout event.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n * @param {Bool} triggerTotalsChanged Determines if totalsChanged event should fire.\n */\nexport function update( e, spFormElem, formData, triggerTotalsChanged = true ) {\n\tconst customAmountInput = spFormElem.find( '.simpay-custom-amount-input' );\n\tconst errorEl = spFormElem.find( '.simpay-errors' );\n\n\t// Exit if no custom amount field.\n\tif ( 0 === customAmountInput.length ) {\n\t\treturn true;\n\t}\n\n\tconst {\n\t\tconvertToCents,\n\t\tformatCurrency,\n\t\tunformatCurrency,\n\t} = window.spShared;\n\n\t// Update internal traacking.\n\tconst unformattedAmount = customAmountInput.val();\n\n\tif ( formData.isSubscription ) {\n\t\tformData.customAmount = unformatCurrency( '' !== unformattedAmount ? unformattedAmount : formData.subMinAmount );\n\t\tformData.planAmount = formData.customAmount;\n\t\tformData.customPlanAmount = formData.planAmount;\n\t} else {\n\t\tformData.customAmount = unformatCurrency( '' !== unformattedAmount ? unformattedAmount : formData.minAmount );\n\t}\n\n\tlet minAmount;\n\tlet isValid;\n\n\t// Compare amount in cents.\n\tconst customAmountVal = unformatCurrency( customAmountInput.val() );\n\n\t// Subscriptions minimum amount requirement is separate from one-time minimum amount requirement.\n\tif ( formData.isSubscription ) {\n\t\tminAmount = unformatCurrency( formData.subMinAmount );\n\t} else {\n\t\tminAmount = unformatCurrency( formData.minAmount );\n\t}\n\n\t// Make sure custom amount meets minimum value.\n\t// Give does: ( ( -1 < amount ) && ( amount >= min_amount ) )\n\tisValid = ( ( -1 < customAmountVal ) && ( customAmountVal >= minAmount ) );\n\n\tif ( isValid ) {\n\t\terrorEl.empty();\n\t\tcustomAmountInput.removeClass( 'simpay-input-error' );\n\t} else {\n\t\t// Set error message.\n\t\tif ( formData.isSubscription ) {\n\t\t\terrorEl.html( formData.subMinCustomAmountError );\n\t\t} else {\n\t\t\terrorEl.html( formData.minCustomAmountError );\n\t\t}\n\n\t\t// Change amount input border color w/ CSS class.\n\t\tcustomAmountInput.addClass( 'simpay-input-error' );\n\t}\n\n\ttry {\n\t\tconst item = spFormElem.cart.getLineItem( 'base' );\n\n\t\titem.update( {\n\t\t\tamount: convertToCents( customAmountVal ),\n\t\t} );\n\n\t\t// Backwards compatibility.\n\t\tcustomAmountInput.val( formatCurrency( customAmountVal, false ) );\n\n\t\t// Call this directly in case the trigger is not run.\n\t\tupdateTotalAmountLabels( e, spFormElem, formData );\n\n\t\tif ( true === triggerTotalsChanged ) {\n\t\t\t// Alert the rest of the components they need to update.\n\t\t\tspFormElem.trigger( 'totalChanged', [ spFormElem, formData ] );\n\t\t}\n\n\t\treturn isValid;\n\t} catch {\n\t\t// Error is logged, UI does not need updating.\n\t\treturn false;\n\t}\n}\n\n/**\n * Mark the form as using a custom amount.\n *\n * @param {Event} e Focus event.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function enableCustomPlanAmount( e, spFormElem, formData ) {\n\tconst customOption = spFormElem.find( '.simpay-custom-plan-option[value=\"simpay_custom_plan\"]' );\n\n\tconst {\n\t\tconvertToCents,\n\t} = window.spShared;\n\n\tcustomOption\n\t\t.prop( 'checked', true )\n\t\t.trigger( 'change' );\n\n\tformData.useCustomPlan = true;\n\tformData.customPlanAmount = convertToCents( customOption.val() );\n\n\tspFormElem.find( '.simpay-has-custom-plan' ).val( 'true' );\n}\n","/* global jQuery, datepicker */\n\n/**\n * Initailize jQuery UI datepicker.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function setup( e, spFormElem, formData ) {\n\tif ( ! $.datepicker ) {\n\t\treturn;\n\t}\n\n\tconst dateInputEl = spFormElem.find( '.simpay-date-input' );\n\n\tdateInputEl.datepicker( {\n\t\tdateFormat: formData.dateFormat,\n\t\tbeforeShow() {\n\t\t\tjQuery( '.ui-datepicker' ).css( 'font-size', 14 );\n\t\t},\n\t} );\n}\n","/**\n * Update form data when a plan changes.\n *\n * @param {Event} e Change event.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function update( e, spFormElem, formData ) {\n\tconst {\n\t\tconvertToCents,\n\t\tformatCurrency,\n\t\tunformatCurrency,\n\t} = window.spShared;\n\n\tconst wrapperElem = spFormElem.find( '.simpay-plan-wrapper' );\n\n\tif ( 0 === wrapperElem.length ) {\n\t\treturn;\n\t}\n\n\tconst errorEl = spFormElem.find( '.simpay-errors' );\n\tconst customAmountInput = spFormElem.find( '.simpay-custom-amount-input' );\n\tconst options = wrapperElem.find( '.simpay-multi-sub' );\n\n\tlet selectedOption = '';\n\n\tlet\n\t\tplanId,\n\t\tplanName,\n\t\tplanSetupFee,\n\t\tplanAmount,\n\t\tplanInterval,\n\t\tplanIntervalCount,\n\t\tplanTrial,\n\t\tplanMaxCharges;\n\n\t// Check if it is a dropdown or a radio button setup and act accordingly\n\tif ( options.first().is( 'option' ) ) {\n\t\tselectedOption = options.filter( ':selected' );\n\t} else {\n\t\tselectedOption = options.filter( ':checked' );\n\t}\n\n\tplanId = selectedOption.data( 'plan-id' ) || '';\n\tplanName = selectedOption.text();\n\tplanSetupFee = selectedOption.data( 'plan-setup-fee' ) || 0;\n\tplanAmount = selectedOption.data( 'plan-amount' ) || 0;\n\tplanInterval = selectedOption.data( 'plan-interval' ) || '';\n\tplanIntervalCount = selectedOption.data( 'plan-interval-count' ) || 1;\n\tplanTrial = ( undefined !== selectedOption.data( 'plan-trial' ) );\n\tplanMaxCharges = selectedOption.data( 'plan-max-charges' ) || 0;\n\n\tif ( planTrial ) {\n\t\tformData.amount = 0;\n\t}\n\n\t// Backwards compatibility.\n\tformData = {\n\t\t...formData,\n\t\tplanId,\n\t\tplanSetupFee,\n\t\tplanAmount,\n\t\tplanInterval,\n\t\tplanIntervalCount,\n\t\tisTrial: planTrial,\n\t};\n\n\t// Update custom amount checker\n\tif ( selectedOption.hasClass( 'simpay-custom-plan-option' ) ) {\n\t\tspFormElem.find( '.simpay-has-custom-plan' ).val( 'true' );\n\t} else {\n\t\tspFormElem.find( '.simpay-has-custom-plan' ).val( '' );\n\t}\n\n\t// Backwards compatibility.\n\tformData.useCustomPlan = ( 'simpay_custom_plan' === selectedOption.val() );\n\n\t// Reset custom amount validation.\n\terrorEl.empty();\n\tcustomAmountInput.removeClass( 'simpay-input-error' );\n\n\t// If the custom amount plan is selected, focus input & blank out value.\n\t// If an existing plan is selected, don't focus input & set input to plan value.\n\tif ( formData.useCustomPlan ) {\n\t\tcustomAmountInput.val( '' );\n\t\tformData.amount = 0;\n\n\t\tif ( ! customAmountInput.is( ':focus' ) ) {\n\t\t\tcustomAmountInput.focus();\n\t\t}\n\t} else {\n\t\tcustomAmountInput.val( formatCurrency( planAmount ) );\n\t}\n\n\tconst {\n\t\tcart,\n\t} = spFormElem;\n\n\ttry {\n\t\t// Update cart's setup fee.\n\t\tconst setupFeeItem = cart.getLineItem( 'plan-setup-fee' );\n\n\t\tsetupFeeItem.update( {\n\t\t\tamount: convertToCents( unformatCurrency( planSetupFee ) ),\n\t\t} );\n\n\t\t// Update cart's base amount.\n\t\tconst item = cart.getLineItem( 'base' );\n\n\t\titem.update( {\n\t\t\ttitle: planName || item.title,\n\t\t\tamount: convertToCents( planAmount ),\n\t\t\tsubscription: {\n\t\t\t\tisTrial: planTrial,\n\t\t\t\tinterval: planInterval,\n\t\t\t\tintervalCount: planIntervalCount,\n\t\t\t},\n\t\t} );\n\n\t\t// Backwards compatibility.\n\t\tspFormElem.find( '.simpay-multi-plan-id' ).val( planId );\n\t\tspFormElem.find( '.simpay-multi-plan-setup-fee' ).val( planSetupFee );\n\t\tspFormElem.find( '.simpay-max-charges' ).val( planMaxCharges );\n\n\t\t// Custom trigger after completed.\n\t\tspFormElem.trigger( 'simpayMultiPlanChanged' );\n\n\t\t// Alert the rest of the components they need to update.\n\t\tspFormElem.trigger( 'totalChanged', [ spFormElem, formData ] );\n\t} catch ( error ) {\n\t\t// Error is logged, UI does not need updating.\n\t}\n}\n","/* global _, $ */\n\n/**\n * Internal dependencies.\n */\nimport { update as updateCustomAmount } from '@wpsimplepay/pro/frontend/components/custom-amount.js';\nimport { handle as handleSource } from '@wpsimplepay/pro/frontend/payment-methods/card';\n\n/**\n * Setup and enable Payment Request Button if needed.\n *\n * @param {Object} spFormElem Form element.\n * @param {Object} formData Payment form data.\n */\nexport function setup( e, spFormElem, formData ) {\n\tconst {\n\t\tformId,\n\t\tformInstance,\n\t\tformDisplayType,\n\t\tstripeParams: {\n\t\t\tcountry,\n\t\t\tcurrency,\n\t\t},\n\t\thasPaymentRequestButton,\n\t} = formData;\n\n\tif ( ! hasPaymentRequestButton ) {\n\t\treturn;\n\t}\n\n\tconst {\n\t\tid,\n\t\ti18n,\n\t\trequestPayerName,\n\t\trequestPayerEmail,\n\t\trequestShipping,\n\t\tshippingOptions,\n\t\ttype,\n\t} = hasPaymentRequestButton;\n\n\tconst {\n\t\ttriggerBrowserValidation,\n\t\tdisableForm,\n\t} = window.simpayApp;\n\n\tconst {\n\t\tpaymentRequestButtons,\n\t} = window.simpayAppPro;\n\n\tconst {\n\t\tconvertToCents,\n\t} = window.spShared;\n\n\tconst {\n\t\tstripeInstance: stripe,\n\t\tcart,\n\t} = spFormElem;\n\n\tconst stripeElements = stripe.elements();\n\n\tconst key = `${ formInstance }-${ formId }`;\n\n\t// Generate initial state of button. Eventually used to generate a request.\n\tpaymentRequestButtons[ key ] = stripe.paymentRequest( {\n\t\tcountry,\n\t\tcurrency: currency.toLowerCase(),\n\t\ttotal: {\n\t\t\tlabel: i18n.totalLabel,\n\t\t\tamount: cart.getTotal(),\n\t\t},\n\t\tdisplayItems: getDisplayItems( spFormElem, formData ),\n\t\trequestPayerName,\n\t\trequestPayerEmail,\n\t\trequestShipping,\n\t} );\n\n\t// Create the button element to render.\n\tconst prButton = stripeElements.create( 'paymentRequestButton', {\n\t\tpaymentRequest: paymentRequestButtons[ key ],\n\t\tstyle: {\n\t\t\tpaymentRequestButton: {\n\t\t\t\ttype,\n\t\t\t},\n\t\t},\n\t} );\n\n\t// Check the availability of the Payment Request API.\n\t// @todo Remove anonymous function usage.\n\tpaymentRequestButtons[ key ]\n\t\t.canMakePayment()\n\t\t.then( ( result ) => {\n\t\t\t// Hide container if no payment can be made.\n\t\t\tif ( null === result ) {\n\t\t\t\tconst containers = document.querySelectorAll( `form[data-simpay-form-id=\"${ formId }\"] #${ id }` );\n\n\t\t\t\tif ( containers.length > 0 ) {\n\t\t\t\t\t_.each( containers, ( container ) => ( container.style.display = 'none' ) );\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet toMount;\n\n\t\t\t/**\n\t\t\t * Due to lack of formInstance context during Overlay toggles we can reference\n\t\t\t * the last instance of the NodeList for PRB containers (based on formId) instead.\n\t\t\t *\n\t\t\t * This ensures the PRB that appears in the overlays (which is always the last\n\t\t\t * in the NodeList) is always the one being mounted (or remounted).\n\t\t\t *\n\t\t\t * @link https://github.com/wpsimplepay/wp-simple-pay-pro/issues/1002\n\t\t\t * @link https://github.com/wpsimplepay/wp-simple-pay-pro/issues/610\n\t\t\t * @link https://github.com/wpsimplepay/wp-simple-pay-pro/issues/645\n\t\t\t *\n\t\t\t * @see {overlays.js:setup}\n\t\t\t */\n\t\t\tif ( 'overlay' === formDisplayType ) {\n\t\t\t\tconst buttons = document.querySelectorAll( `form[data-simpay-form-id=\"${ formData.formId }\"] #${ formData.hasPaymentRequestButton.id } .simpay-payment-request-button-container__button` );\n\n\t\t\t\ttoMount = buttons[ buttons.length - 1 ];\n\t\t\t} else {\n\t\t\t\ttoMount = document.querySelector( `form[data-simpay-form-instance=\"${ formData.formInstance }\"] #${ formData.hasPaymentRequestButton.id } .simpay-payment-request-button-container__button` );\n\t\t\t}\n\n\t\t\tif ( toMount ) {\n\t\t\t\ttoMount.innerHTML = '';\n\t\t\t\tprButton.mount( toMount );\n\t\t\t}\n\n\t\t\t// Ensure form is valid before continuing.\n\t\t\tprButton.on( 'click', function( e ) {\n\t\t\t\tif ( ! paymentRequestIsValid( spFormElem, formData ) ) {\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t// Show browser validation.\n\t\t\t\t\ttriggerBrowserValidation( spFormElem, formData );\n\t\t\t\t}\n\n\t\t\t\t// Update custom amount and recalculate, but do not attempt to update PRB.\n\t\t\t\tconst isCustomAmountValid = updateCustomAmount( null, spFormElem, formData, false );\n\n\t\t\t\tif ( ! isCustomAmountValid ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\n\t\t\t\t// Update items for a final time.\n\t\t\t\tupdate( spFormElem, formData );\n\t\t\t} );\n\t\t} );\n\n\t/**\n\t * Update shipping options for request.\n\t * There are no defined shipping methods, so this is merely to satisfy the API requirements.\n\t *\n\t * @todo Remove anonymous function usage.\n\t * @todo Populate hidden fields so the values are sent through?\n\t *\n\t * @param {Object} e Payment Request Button event.\n\t */\n\tpaymentRequestButtons[ key ].on( 'shippingaddresschange', function( e ) {\n\t\te.updateWith( {\n\t\t\tstatus: 'success',\n\t\t\tshippingOptions: shippingOptions,\n\t\t} );\n\t} );\n\n\t/**\n\t * Handle token once created.\n\t *\n\t * @param {Object} e Payment Request Button event.\n\t */\n\tpaymentRequestButtons[ key ].on( 'source', function( e ) {\n\t\tconst {\n\t\t\tpayerEmail,\n\t\t\tpayerName,\n\t\t\tcomplete,\n\t\t} = e;\n\n\t\tdisableForm( spFormElem, formData, true );\n\n\t\tcomplete( 'success' );\n\n\t\tif ( payerEmail && '' !== payerEmail ) {\n\t\t\t$( '<input>' ).attr( {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tname: 'simpay_email',\n\t\t\t\tvalue: payerEmail,\n\t\t\t} ).appendTo( spFormElem );\n\t\t}\n\n\t\tif ( payerName && '' !== payerName ) {\n\t\t\t$( '<input>' ).attr( {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tname: 'simpay_name',\n\t\t\t\tvalue: payerName,\n\t\t\t} ).appendTo( spFormElem );\n\t\t}\n\n\t\treturn handleSource( e, spFormElem, formData );\n\t} );\n}\n\n/**\n * Update Payment Request Button when data changes.\n *\n * @todo Separate out total and item generators.\n *\n * @param {Object} spFormElem Form element.\n * @param {Object} formData Payment form data.\n */\nexport function update( spFormElem, formData ) {\n\tconst {\n\t\tformId,\n\t\tformInstance,\n\t\thasPaymentRequestButton,\n\t} = formData;\n\n\tif ( ! hasPaymentRequestButton ) {\n\t\treturn;\n\t}\n\n\tconst {\n\t\ti18n,\n\t} = hasPaymentRequestButton;\n\n\tconst {\n\t\tpaymentRequestButtons,\n\t} = window.simpayAppPro;\n\n\tconst {\n\t\tconvertToCents,\n\t} = window.spShared;\n\n\tconst {\n\t\tcart,\n\t} = spFormElem;\n\n\tconst key = `${ formInstance }-${ formId }`;\n\n\t// Enable if not previously setup.\n\tif ( ! paymentRequestButtons.hasOwnProperty( key ) ) {\n\t\tsetup( null, spFormElem, formData );\n\t}\n\n\tpaymentRequestButtons[ key ].update( {\n\t\ttotal: {\n\t\t\tlabel: i18n.totalLabel,\n\t\t\tamount: cart.getTotal(),\n\t\t},\n\t\tdisplayItems: getDisplayItems( spFormElem, formData ),\n\t} );\n}\n\n/**\n * Custom check to see if relevant custom fields are valid before allowing Payment Button Request.\n *\n * @param {Object} spFormElem Form element.\n * @param {Object} formData Payment form data.\n */\nexport function paymentRequestIsValid( spFormElem, formData ) {\n\t/**\n\t * Determine if a form control is a \"classic\" field, meaning it is needed\n\t * to submit a standard payment form instead of using the Payment Request API.\n\t *\n\t * @param {HTMLElement} control Form control.\n\t * @return {bool} If the field is classic.\n\t */\n\tfunction isClassicField( control ) {\n\t\tconst classicFields = [\n\t\t\t'simpay-customer-name-container',\n\t\t\t'simpay-email-container',\n\t\t\t'simpay-card-container',\n\t\t\t'simpay-address-container',\n\t\t\t'simpay-address-street-container',\n\t\t\t'simpay-address-city-container',\n\t\t\t'simpay-address-state-container',\n\t\t\t'simpay-address-zip-container',\n\t\t\t'simpay-address-country-container',\n\t\t\t'simpay-telephone-container',\n\t\t];\n\n\t\tconst classList = control.classList;\n\t\tlet is = false;\n\n\t\tclassList.forEach( function( className ) {\n\t\t\tif ( -1 !== classicFields.indexOf( className ) ) {\n\t\t\t\tis = true;\n\t\t\t}\n\t\t} );\n\n\t\treturn is;\n\t}\n\n\tlet requiredFieldsValid = true;\n\n\t_.each( spFormElem[0].querySelectorAll( '.simpay-form-control' ), function( control ) {\n\t\tconst classicField = isClassicField( control );\n\n\t\tif ( classicField ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputs = control.querySelectorAll( 'input' );\n\n\t\t_.each( inputs, function( input ) {\n\t\t\tif ( ! input.required ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( ! input.validity.valid ) {\n\t\t\t\trequiredFieldsValid = false;\n\t\t\t}\n\t\t} );\n\t} );\n\n\treturn requiredFieldsValid;\n}\n\n/**\n * Generate Payment Request API displayItems from form data.\n *\n * @param {Object} spFormElem Form element.\n * @param {Object} formData Form data.\n * @return {Array}\n */\nexport function getDisplayItems( spFormElem, formData ) {\n\tconst displayItems = [];\n\n\tconst {\n\t\tconvertToCents,\n\t} = window.spShared;\n\n\tconst {\n\t\tcart,\n\t} = spFormElem;\n\n\tconst {\n\t\thasPaymentRequestButton: {\n\t\t\ti18n,\n\t\t}\n\t} = formData;\n\n\t// Add subscription plan to list.\n\ttry {\n\t\tconst plan = cart.getLineItem( 'base' );\n\n\t\tdisplayItems.push( {\n\t\t\tlabel: plan.title ? plan.title : i18n.planLabel,\n\t\t\tamount: plan.getSubtotal(),\n\t\t} );\n\t} catch ( error ) {\n\t\t// Item couldn't be found, do not add it.\n\t}\n\n\t// Combine setup fees to a single line.\n\tlet setupFeeAmount = 0;\n\n\ttry {\n\t\tconst planSetupFee = cart.getLineItem( 'plan-setup-fee' );\n\t\tsetupFeeAmount += planSetupFee.getSubtotal();\n\t} catch ( error ) {\n\t\t// Item couldn't be found, do not add it.\n\t}\n\n\ttry {\n\t\tconst setupFee = cart.getLineItem( 'setup-fee' );\n\t\tsetupFeeAmount += setupFee.getSubtotal();\n\t} catch ( error ) {\n\t\t// Item couldn't be found, do not add it.\n\t}\n\n\tif ( setupFeeAmount > 0 ) {\n\t\tdisplayItems.push( {\n\t\t\tlabel: i18n.setupFeeLabel,\n\t\t\tamount: setupFeeAmount,\n\t\t} );\n\t}\n\n\t// Add tax to list.\n\tif ( cart.taxPercent > 0 ) {\n\t\tdisplayItems.push( {\n\t\t\tlabel: i18n.taxLabel.replace( '%s', cart.getTaxPercent() ),\n\t\t\tamount: cart.getTax(),\n\t\t} );\n\t}\n\n\t// Add tax to list.\n\tif ( cart.getDiscount() > 0 ) {\n\t\tdisplayItems.push( {\n\t\t\tlabel: i18n.couponLabel.replace( '%s', cart.getCoupon().name ),\n\t\t\tamount: cart.getDiscount() * -1,\n\t\t} );\n\t}\n\n\treturn displayItems;\n}\n","/**\n * Internal dependencies.\n */\nimport { apply as applyCoupon } from './coupon.js';\nimport { update as updateTotalAmountLabels } from './total-amount-labels.js';\n\nexport function update( e, spFormElem, formData ) {\n\tlet quantity = 1;\n\n\t// Backwards compatibility.\n\tformData.quantity = quantity;\n\n\tconst cart = spFormElem.cart;\n\n\tif ( spFormElem.find( '.simpay-quantity-dropdown' ).length ) {\n\t\tquantity = parseFloat( spFormElem.find( '.simpay-quantity-dropdown' ).find( 'option:selected' ).data( 'quantity' ) );\n\n\t\tspFormElem.trigger( 'simpayDropdownQuantityChange' );\n\t} else if ( spFormElem.find( '.simpay-quantity-radio' ).length ) {\n\t\tquantity = parseFloat( spFormElem.find( '.simpay-quantity-radio' ).find( 'input[type=\"radio\"]:checked' ).data( 'quantity' ) );\n\n\t\tspFormElem.trigger( 'simpayRadioQuantityChange' );\n\t} else if ( spFormElem.find( '.simpay-quantity-input' ).length ) {\n\t\tquantity = parseFloat( spFormElem.find( '.simpay-quantity-input' ).val() );\n\n\t\tspFormElem.trigger( 'simpayNumberQuantityChange' );\n\t}\n\n\tif ( quantity < 1 ) {\n\t\tquantity = 1;\n\t}\n\n\t// Set cart base item quantity.\n\ttry {\n\t\tconst item = spFormElem.cart.getLineItem( 'base' );\n\n\t\titem.update( {\n\t\t\tquantity,\n\t\t} );\n\n\t\t// Backwards compatibility.\n\t\tformData.quantity = quantity;\n\n\t\t// Update hidden quantity field.\n\t\tspFormElem.find( '.simpay-quantity' ).val( quantity );\n\n\t\t// Alert the rest of the components they need to update.\n\t\tspFormElem.trigger( 'totalChanged', [ spFormElem, formData ] );\n\t} catch ( error ) {\n\t\t// Error is logged, UI does not need updating.\n\t}\n}\n","/**\n * Update all labels.\n *\n * @param {Event} e Change event.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function update( e, spFormElem, formData ) {\n\ttotalAmount( spFormElem, formData );\n\trecurringAmount( spFormElem, formData );\n\ttaxAmount( spFormElem, formData );\n}\n\n/**\n * Update \"Total Amount\" label, and Submit Button label.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nfunction totalAmount( spFormElem, formData ) {\n\tconst {\n\t\tconvertToDollars,\n\t\tformatCurrency,\n\t} = window.spShared;\n\n\tconst {\n\t\tcart,\n\t} = spFormElem;\n\n\tconst total = convertToDollars( cart.getTotal() );\n\tconst formatted = formatCurrency( total, true );\n\n\t// @todo Remove and run elsewhere.\n\twindow.simpayApp.setCoreFinalAmount( spFormElem, formData );\n\n\tspFormElem.find( '.simpay-total-amount-value' ).text( formatted );\n}\n\n/**\n * Update \"Recurring Amount\" label.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nfunction recurringAmount( spFormElem, formData ) {\n\tconst {\n\t\tconvertToDollars,\n\t\tformatCurrency,\n\t} = window.spShared;\n\n\tconst {\n\t\tcart,\n\t} = spFormElem;\n\n\ttry {\n\t\tconst item = cart.getLineItem( 'base' );\n\n\t\tconst {\n\t\t\tsubscription: {\n\t\t\t\tinterval,\n\t\t\t\tintervalCount,\n\t\t\t},\n\t\t} = item;\n\n\t\tconst recurringAmountFinal = convertToDollars( item.getTotal() );\n\n\t\tlet recurringAmountFormatted = formatCurrency( recurringAmountFinal, true );\n\n\t\tif ( intervalCount > 1 ) {\n\t\t\trecurringAmountFormatted += ' every ' + intervalCount + ' ' + interval + 's';\n\t\t} else {\n\t\t\trecurringAmountFormatted += '/' + interval;\n\t\t}\n\n\t\tspFormElem.find( '.simpay-total-amount-recurring-value' ).text( recurringAmountFormatted );\n\t} catch ( error ) {\n\t\t// Fallback to cart total.\n\t\tconst cartTotal = formatCurrency( convertToDollars( cart.getTotal() ), true );\n\n\t\treturn spFormElem.find( '.simpay-total-amount-recurring-value' ).text( cartTotal );\n\t}\n}\n\n/**\n * Update \"Tax Amount\" label.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nfunction taxAmount( spFormElem, formData ) {\n\tconst {\n\t\tconvertToDollars,\n\t\tformatCurrency,\n\t} = window.spShared;\n\n\tconst {\n\t\tcart,\n\t} = spFormElem;\n\n\tconst taxAmount = convertToDollars( cart.getTax() );\n\tconst formatted = formatCurrency( taxAmount, true );\n\n\tspFormElem.find( '.simpay-tax-amount-value' ).text( formatted );\n}\n","/* global simplePayForms, spGeneral, jQuery, Stripe */\n\n/**\n * Internal dependencies.\n */\nimport { default as simpayAppProCompat } from './compat.js';\n\nimport { setup as setupPaymentForm } from './payment-forms/stripe-elements';\nimport { setup as setupOverlayModals } from './payment-forms/stripe-elements/overlays.js';\nimport { setup as setupDateField } from './components/date.js';\n\nimport { update as updateTotalAmountLabels } from './components/total-amount-labels.js';\nimport { update as updateMultiSubSelection } from './components/multi-sub.js';\nimport { update as updateQuantityField } from './components/quantity.js';\nimport { update as updateAmountField } from './components/amount.js';\n\nimport { toggleShippingAddressFields } from './components/address.js';\n\nimport {\n\tsetup as setupPaymentRequestButtons,\n\tupdate as updatePaymentRequestButtons,\n} from './components/payment-request-button.js';\n\nimport {\n\tupdate as updateCustomAmount,\n\tenableCustomPlanAmount,\n} from './components/custom-amount.js';\n\nimport {\n\tapply as applyCoupon,\n\tremove as removeCoupon,\n} from './components/coupon.js';\n\nlet simpayAppPro = {};\n\n( function( $ ) {\n\t'use strict';\n\n\tconst body = $( document.body );\n\n\t/**\n\t * Manage additional \"Pro\" functionality.\n\t *\n\t * This object mainly serves as a backwards compatibility shim.\n\t */\n\tsimpayAppPro = {\n\t\t// Manage multiple payment request buttons.\n\t\tpaymentRequestButtons: {},\n\n\t\t/**\n\t\t * Setup Payment Forms.\n\t\t */\n\t\tinit() {\n\t\t\t// Let `bindEvents` access other object property functions via `this`.\n\t\t\tthis.bindEvents = this.bindEvents.bind( this );\n\n\t\t\t// Setup the payment form.\n\t\t\tbody.on( 'simpayCoreFormVarsInitialized', setupPaymentForm );\n\n\t\t\tbody.on( 'simpayBindCoreFormEventsAndTriggers', setupOverlayModals );\n\t\t\tbody.on( 'simpayBindCoreFormEventsAndTriggers', setupDateField );\n\n\t\t\t// Bind interactions.\n\t\t\tbody.on( 'simpayBindCoreFormEventsAndTriggers', this.bindEvents );\n\n\t\t\tbody.on( 'simpayBindCoreFormEventsAndTriggers', updateCustomAmount );\n\t\t\tbody.on( 'simpayBindCoreFormEventsAndTriggers', updateQuantityField );\n\t\t\tbody.on( 'simpayBindCoreFormEventsAndTriggers', updateAmountField );\n\t\t\tbody.on( 'simpayBindCoreFormEventsAndTriggers', updateMultiSubSelection );\n\n\t\t\t//\n\t\t\t// This is a very important binding, as it eventually comes full circle calling\n\t\t\t// the `simpayFinalizeCoreAmount` trigger, which updates the final amount.\n\t\t\t//\n\t\t\t// This updateTotalAmountLabels also includes the submit button label.\n\t\t\t//\n\t\t\t// 1. updateTotalAmountLabels\n\t\t\t// 2. simpayApp.setCoreFinalAmount\n\t\t\t//      trigger:simpayFinalizeCoreAmount\n\t\t\t// 3. this.updateAmounts\n\t\t\t//\n\t\t\t// To alert of a form value change, `totalChanged` trigger should be fired.\n\t\t\t// This will call `updateTotalAmountLabels` and start the steps above again.\n\t\t\t//\n\t\t\t// The current circular logic remains for backwards compatibility.\n\t\t\t//\n\t\t\tbody.on( 'simpayBindCoreFormEventsAndTriggers', updateTotalAmountLabels );\n\t\t\tbody.on( 'simpayFinalizeCoreAmount', this.updateAmounts );\n\t\t},\n\n\t\tbindEvents( e, spFormElem, formData ) {\n\t\t\t// Toggle focus class for easier styling with CSS.\n\t\t\tthis.setOnFieldFocus( spFormElem );\n\n\t\t\t// Update any components that need to use new total values after change.\n\t\t\tspFormElem.on(\n\t\t\t\t'totalChanged',\n\t\t\t\t/**\n\t\t\t\t * Runs when the total amount has changed.\n\t\t\t\t *\n\t\t\t\t * @param {Event} e Event.\n\t\t\t\t * @param {jQuery} spFormElem Form element jQuery object.\n\t\t\t\t * @param {Object} formData Configured form data.\n\t\t\t\t * @param {Bool} _removeCoupon Determines if the coupon should be removed or not. Defaults false.\n\t\t\t\t */\n\t\t\t\t( e, spFormElem, formData, _removeCoupon = true ) => {\n\t\t\t\t\tif ( true === _removeCoupon ) {\n\t\t\t\t\t\tremoveCoupon( spFormElem, formData );\n\t\t\t\t\t}\n\n\t\t\t\t\tupdateTotalAmountLabels( e, spFormElem, formData );\n\t\t\t\t\tupdatePaymentRequestButtons( spFormElem, formData );\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t/**\n\t\t\t * Validate custom field amount before a form is submitted.\n\t\t\t *\n\t\t\t * @param {Event} e Event.\n\t\t\t * @param {jQuery} spFormElem Form element jQuery object.\n\t\t\t * @param {Object} formData Configured form data.\n\t\t\t */\n\t\t\tspFormElem.on( 'simpayBeforeStripePayment', ( e, spFormElem, formData ) => {\n\t\t\t\t// Backwards compatibility.\n\t\t\t\t// `simpayBeforeStripePayment` should be used directly.\n\t\t\t\tspFormElem.trigger( 'simpayFormValidationInitialized' );\n\n\t\t\t\tconst isCustomAmountValid = updateCustomAmount( e, spFormElem, formData, false );\n\n\t\t\t\tformData.isValid = isCustomAmountValid;\n\t\t\t} );\n\n\t\t\t/**\n\t\t\t * Validate and update amounts when the \"Custom Amount\" field loses focus.\n\t\t\t *\n\t\t\t * @param {Event} e Focusout event.\n\t\t\t */\n\t\t\tspFormElem.find( '.simpay-custom-amount-input' ).on( 'focusout', ( e ) => updateCustomAmount( e, spFormElem, formData ) );\n\n\t\t\t/**\n\t\t\t * Toggle the internal flags that a custom amount is being used for Subscriptions.\n\t\t\t *\n\t\t\t * @param {Event} e Focusin event.\n\t\t\t */\n\t\t\tspFormElem.find( '.simpay-custom-amount-input' ).on( 'focusin', ( e ) => enableCustomPlanAmount( e, spFormElem, formData ) );\n\n\t\t\t/**\n\t\t\t * Apply a coupon when the \"Apply\" button is clicked.\n\t\t\t *\n\t\t\t * @param {Event} e Click event.\n\t\t\t */\n\t\t\tspFormElem.find( '.simpay-apply-coupon' ).on( 'click', ( e ) => {\n\t\t\t\te.preventDefault();\n\n\t\t\t\treturn applyCoupon( spFormElem, formData );\n\t\t\t} );\n\n\t\t\t/**\n\t\t\t * Apply a coupon when the \"Enter\" key is pressed while focusing on the input field.\n\t\t\t *\n\t\t\t * @param {Event} e Click event.\n\t\t\t */\n\t\t\tspFormElem.find( '.simpay-coupon-field' ).on( 'keypress', ( e ) => {\n\t\t\t\tif ( 13 !== e.which ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\n\t\t\t\treturn applyCoupon( spFormElem, formData );\n\t\t\t} );\n\n\t\t\t/**\n\t\t\t * Remove a coupon when the \"Remove\" button is clicked.\n\t\t\t *\n\t\t\t * @param {Event} e Click event.\n\t\t\t */\n\t\t\tspFormElem.find( '.simpay-remove-coupon' ).on( 'click', ( e ) => {\n\t\t\t\te.preventDefault();\n\n\t\t\t\treturn removeCoupon( spFormElem, formData );\n\t\t\t} );\n\n\t\t\t/**\n\t\t\t * Update amounts when a multi-plan subscription form updates.\n\t\t\t *\n\t\t\t * @param {Event} e Change event.\n\t\t\t */\n\t\t\tspFormElem.find( '.simpay-multi-sub, .simpay-plan-wrapper select' ).on( 'change', ( e ) => updateMultiSubSelection( e, spFormElem, formData ) );\n\n\t\t\t/**\n\t\t\t * Update amounts when a \"Quantity\" input changes.\n\t\t\t *\n\t\t\t * @param {Event} e Change event.\n\t\t\t */\n\t\t\tspFormElem.find( '.simpay-quantity-input, .simpay-quantity-dropdown' ).on( 'change', ( e ) => updateQuantityField( e, spFormElem, formData ) );\n\n\t\t\t/**\n\t\t\t * Update amounts when an \"Amount\" input changes.\n\t\t\t *\n\t\t\t * @param {Event} e Change\n\t\t\t */\n\t\t\tspFormElem.find( '.simpay-amount-dropdown, .simpay-amount-radio' ).on( 'change', ( e ) => updateAmountField( e, spFormElem, formData ) );\n\t\t\t/**\n\t\t\t * Toggle shipping fields when \"Same billing & shipping info\" is toggled.\n\t\t\t *\n\t\t\t * @param {Event} e Change event.\n\t\t\t */\n\t\t\tspFormElem.find( '.simpay-same-address-toggle' ).on( 'change', ( e ) => toggleShippingAddressFields( spFormElem, formData ) );\n\n\t\t\t/**\n\t\t\t * Toggle a recurring charge (generates a Subscription).\n\t\t\t *\n\t\t\t * @param {Event} e Change event.\n\t\t\t */\n\t\t\tspFormElem.find( 'input[name=\"recurring_amount_toggle\"]' ).on( 'change', ( e ) => {\n\t\t\t\tformData.isRecurring = e.target.checked;\n\t\t\t} );\n\n\t\t\t// Allow further processing.\n\t\t\tbody.trigger( 'simpayBindProFormEventsAndTriggers', [ spFormElem, formData ] );\n\t\t},\n\n\t\t/**\n\t\t * Toggle `is-focused` class on fields to allow for extra CSS styling.\n\t\t *\n\t\t * @param {jQuery} spFormElem Form element jQuery object.\n\t\t * @param {Object} formData Configured form data.\n\t\t */\n\t\tsetOnFieldFocus( spFormElem, formData ) {\n\t\t\tconst fields = spFormElem.find( '.simpay-form-control' );\n\n\t\t\tfields.each( function( i, el ) {\n\t\t\t\tconst field = $( el );\n\n\t\t\t\tfield.on( 'focusin', setFocus );\n\t\t\t\tfield.on( 'focusout', removeFocus );\n\n\t\t\t\t/**\n\t\t\t\t * Add `is-focused` class.\n\t\t\t\t *\n\t\t\t\t * @param {Event} e Event focusin event.\n\t\t\t\t */\n\t\t\t\tfunction setFocus( e ) {\n\t\t\t\t\t$( e.target ).addClass( 'is-focused' );\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Remove `is-focused` class.\n\t\t\t\t *\n\t\t\t\t * @param {Event} e Event focusout event.\n\t\t\t\t */\n\t\t\t\tfunction removeFocus( e ) {\n\t\t\t\t\tconst $el = $( e.target );\n\n\t\t\t\t\t// Wait for DatePicker plugin\n\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\t$el.removeClass( 'is-focused' );\n\n\t\t\t\t\t\tif ( field.val() ) {\n\t\t\t\t\t\t\t$el.addClass( 'is-filled' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$el.removeClass( 'is-filled' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 300 );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Calculate payment amounts.\n\t\t *\n\t\t * @param {Event} e Mixed events. Not used.\n\t\t * @param {jQuery} spFormElem Form element jQuery object.\n\t\t * @param {Object} formData Configured form data.\n\t\t */\n\t\tupdateAmounts( e, spFormElem, formData ) {\n\t\t\tconst {\n\t\t\t\tconvertToDollars,\n\t\t\t\tdebugLog,\n\t\t\t} = window.spShared;\n\n\t\t\ttry {\n\t\t\t\tconst {\n\t\t\t\t\tcart,\n\t\t\t\t} = spFormElem;\n\n\t\t\t\tconst total = cart.getTotal();\n\n\t\t\t\t// Backwards compat.\n\t\t\t\tformData.finalAmount = convertToDollars( total );\n\t\t\t\tformData.stripeParams.amount = total;\n\n\t\t\t\t// Set the same cents value to hidden input for later form submission.\n\t\t\t\tspFormElem.find( '.simpay-amount' ).val( total );\n\n\t\t\t\t// Convert amount to dollars, as the server still expects this.\n\t\t\t\tspFormElem.find( '.simpay-tax-amount' ).val( convertToDollars( cart.getTax() ) );\n\t\t\t} catch ( error ) {\n\t\t\t\tdebugLog( error );\n\t\t\t}\n\t\t},\n\n\t\t...simpayAppProCompat,\n\t};\n\n\tsimpayAppPro.init();\n}( jQuery ) );\n\nwindow.simpayAppPro = simpayAppPro;\n\nexport default simpayAppPro;\n","/* global jQuery */\n\n/**\n * Internal dependencies.\n */\nimport { convertFormDataToCartData } from '@wpsimplepay/cart';\nimport {\n\tCart,\n\n\thandle as handleCardPaymentMethod,\n\tsetup as setupCardPaymentMethod,\n\tcreate as createCardPaymentMethod,\n} from '@wpsimplepay/pro/frontend/payment-methods/card';\n\n\nconst ELEMENTS_DEFAULT_STYLE = {\n\tbase: {\n\t\tcolor: '#32325d',\n\t\tfontFamily: 'Roboto, Open Sans, Segoe UI, sans-serif',\n\t\tfontSize: '15px',\n\t\tfontSmoothing: 'antialiased',\n\t\tfontWeight: 500,\n\n\t\t'::placeholder': {\n\t\t\tcolor: '#aab7c4'\n\t\t}\n\t},\n\tinvalid: {\n\t\tcolor: '#fa755a',\n\t\ticonColor: '#fa755a'\n\t}\n};\n\n/**\n * Gets Element styles based on an existing form input.\n *\n * Injects supplementary styles for the wrapper element.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param cardEl\n * @return {Object} Element style information.\n */\nfunction getElementsStyle( spFormElem, cardEl ) {\n\t// Do nothing if an Element has already been styled;\n\tif ( document.getElementById( 'simpay-stripe-element-styles' ) ) {\n\t\treturn ELEMENTS_DEFAULT_STYLE;\n\t}\n\n\t// Inject inline CSS instead of applying to the Element so it can be overwritten.\n\tconst styleTag = document.createElement( 'style' );\n\tstyleTag.id = 'simpay-stripe-element-styles';\n\n\t// Try to mimick existing input styles.\n\tlet input;\n\n\tinput = document.querySelector( 'input.simpay-email' );\n\n\t// Try one more input in the main page content.\n\tif ( ! input ) {\n\t\tinput = document.querySelector( 'body [role=\"main\"] input:not([type=\"hidden\"])' );\n\t}\n\n\t// Use default styles if no other input exists.\n\tif ( ! input ) {\n\t\tstyleTag.innerHTML = `.StripeElement.simpay-card-wrap {\n\t\t\tbackground: #fff;\n\t\t\tborder: 1px solid #d1d1d1;\n\t\t\tborder-radius: 4px;\n\t\t\tpadding: 0.4375em;\n\t\t\theight: 36px;\n\t\t\tmin-height: 36px;\n\t\t}`;\n\n\t\tdocument.body.appendChild( styleTag );\n\n\t\treturn ELEMENTS_DEFAULT_STYLE;\n\t} else {\n\t\tconst inputStyles = window.getComputedStyle( input );\n\t\tconst placeholderStyles = window.getComputedStyle( input, '::placeholder' );\n\n\t\tconst trbl = [ 'top', 'right', 'bottom', 'left' ].map( ( dir ) => (\n\t\t\t`border-${ dir }-color: ${ inputStyles.getPropertyValue( `border-${ dir }-color` ) };\n\t\t\tborder-${ dir }-width: ${ inputStyles.getPropertyValue( `border-${ dir }-width` ) };\n\t\t\tborder-${ dir }-style: ${ inputStyles.getPropertyValue( `border-${ dir }-style` ) };\n\t\t\tpadding-${ dir }: ${ inputStyles.getPropertyValue( `padding-${ dir }` ) };`\n\t\t) );\n\n\t\tconst corners = [ 'top-right', 'bottom-right', 'bottom-left', 'top-left' ].map( ( corner ) => (\n\t\t\t`border-${ corner }-radius: ${ inputStyles.getPropertyValue( `border-${ corner }-radius` ) };`\n\t\t) );\n\n\t\t// Generate longhand properties.\n\t\tstyleTag.innerHTML = `.StripeElement.simpay-card-wrap {\n\t\t\tbackground-color: ${ inputStyles.getPropertyValue( 'background-color' ) };\n\t\t\t${ trbl.join( '' ) }\n\t\t\t${ corners.join( '' ) }\n\t\t}`;\n\n\t\tdocument.body.appendChild( styleTag );\n\n\t\treturn {\n\t\t\tbase: {\n\t\t\t\tcolor: inputStyles.getPropertyValue( 'color' ),\n\t\t\t\tfontFamily: inputStyles.getPropertyValue( 'font-family' ),\n\t\t\t\tfontSize: inputStyles.getPropertyValue( 'font-size' ),\n\t\t\t\tfontWeight: inputStyles.getPropertyValue( 'font-weight' ),\n\t\t\t\tfontSmoothing: inputStyles.getPropertyValue( '-webkit-font-smoothing' ),\n\t\t\t\t// This can't be fetched dynamically, unfortunately.\n\t\t\t\t'::placeholder': {\n\t\t\t\t\tcolor: '#c7c7c7',\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n}\n\n/**\n * Get Card Element configuration.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param cardEl\n * @param {Object} formData Configured form data.\n * @return {Object}\n */\nexport function getElementsConfig( spFormElem, cardEl ) {\n\t// If a billing address field exists (overrides Card field setting).\n\tconst hidePostalCode = (\n\t\t!! spFormElem[ 0 ].querySelector( '.simpay-address-zip' ) ||\n\t\t'no' === cardEl.dataset.showPostalCode\n\t);\n\n\tconst style = getElementsStyle( spFormElem, cardEl );\n\n\treturn {\n\t\thidePostalCode,\n\t\tstyle,\n\t};\n}\n\n/**\n * Handles an error on Submission.\n *\n * @since 3.7.0\n *\n * @param {Object} error Error data.\n * @param {jquery} spformelem form element jquery object.\n * @param {object} formdata configured form data.\n */\nfunction onError( error, spFormElem, formData ) {\n\t// @todo DRY with other form handling.\n\tif ( ! _.isObject( error ) ) {\n\t\treturn;\n\t}\n\n\tconst {\n\t\tresponseJSON,\n\t\tresponseText,\n\t\tmessage,\n\t} = error;\n\n\tconst foundMessage = ( responseJSON && responseJSON.message ? responseJSON.message : responseText );\n\tconst errorMessage = message ? message : foundMessage;\n\n\tconst {\n\t\tshowError,\n\t\tenableForm,\n\t} = window.simpayApp;\n\n\tconst {\n\t\tdebugLog,\n\t} = window.spShared;\n\n\tshowError( spFormElem, formData, errorMessage );\n\tenableForm( spFormElem, formData );\n\n\tdebugLog( 'Payment Form Error:', error );\n}\n\n/**\n * Submit payment form.\n *\n * @param {Event} e Form submit Event.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nfunction onSubmit( e, spFormElem, formData ) {\n\te.preventDefault();\n\n\t// Remove existing errors.\n\twindow.simpayApp.showError( spFormElem, formData, '' );\n\n\t// Disable form while processing.\n\twindow.simpayApp.disableForm( spFormElem, formData, true );\n\n\t// HTML5 validation check.\n\tif ( ! spFormElem[ 0 ].checkValidity() ) {\n\t\twindow.simpayApp.triggerBrowserValidation( spFormElem, formData );\n\t\twindow.simpayApp.enableForm( spFormElem, formData );\n\n\t\treturn;\n\t}\n\n\t// Allow further validation.\n\t//\n\t// jQuery( document.body ).on( 'simpayBeforeStripePayment', function( e, spFormElem, formData ) {\n\t//  formData.isValid = false;\n\t// } );\n\tspFormElem.trigger( 'simpayBeforeStripePayment', [ spFormElem, formData ] );\n\n\tif ( ! formData.isValid ) {\n\t\twindow.simpayApp.enableForm( spFormElem, formData );\n\n\t\treturn;\n\t}\n\n\ttry {\n\t\tcreateCardPaymentMethod( spFormElem, formData )\n\t\t\t.then( ( result ) => handleCardPaymentMethod( result, spFormElem, formData ) )\n\t\t\t.catch( ( error ) => onError( error, spFormElem, formData ) );\n\t} catch ( error ) {\n\t\tonError( error, spFormElem, formData );\n\t}\n}\n\n/**\n * Bind events for Stripe Elements.\n *\n * @param {Event} e simpayBindCoreFormEventsAndTriggers Event.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function setup( e, spFormElem, formData ) {\n\tconst {\n\t\tisStripeCheckoutForm,\n\t\tdisableForm,\n\t} = window.simpayApp;\n\n\tconst {\n\t\tdebugLog,\n\t} = window.spShared;\n\n\t// Don't continue if this form is using Stripe Checkout.\n\tif ( isStripeCheckoutForm( formData ) ) {\n\t\treturn;\n\t}\n\n\tdisableForm( spFormElem, formData, true );\n\n\t// Cache form elements.\n\tconst realFormElem = spFormElem[ 0 ];\n\tconst submitBtn = realFormElem.querySelector( '.simpay-checkout-btn' );\n\n\tif ( ! submitBtn ) {\n\t\treturn;\n\t}\n\n\ttry {\n\t\t// Create a cart.\n\n\t\t// Convert legacay data in to something usable.\n\t\tconst {\n\t\t\titems,\n\t\t\tcurrency,\n\t\t\ttaxPercent,\n\t\t\tisNonDecimalCurrency,\n\t\t} = convertFormDataToCartData( formData );\n\n\t\tconst cart = new Cart( {\n\t\t\tcurrency,\n\t\t\ttaxPercent,\n\t\t\tisNonDecimalCurrency,\n\t\t} );\n\n\t\tif ( items.length > 0 ) {\n\t\t\titems.forEach( ( item ) => {\n\t\t\t\tcart.addLineItem( item );\n\t\t\t} );\n\t\t}\n\n\t\t// Attach cart.\n\t\tspFormElem.cart = cart;\n\n\t\t// Initilize \"card\" field.\n\t\t// Enables form.\n\t\t// @todo This should be called automatically when a \"Card\" field type is used.\n\t\tsetupCardPaymentMethod( spFormElem, formData );\n\n\t\t// Handle form submission.\n\t\trealFormElem.addEventListener( 'submit', ( e ) => onSubmit( e, spFormElem, formData ) );\n\t} catch ( error ) {\n\t\tdebugLog( error.id, error.message );\n\t}\n}\n","/* global simpayAppPro, _ */\n\n/**\n * Internal dependencies.\n */\nimport { setup as setupPaymentRequestButton } from '@wpsimplepay/pro/frontend/components/payment-request-button.js';\n\n/**\n * Toggle an overlay form's visibility.\n *\n * Attach to any type of link. Useful when the form number is known.\n *\n *   document.querySelector( '.my-link' ).addEventListener( 'click', function( e ) {\n *     e.preventDefault();\n *     simpayAppPro.toggleOverlayForm( 13 );\n *   } );\n *\n * Attach to a button that has an associated form ID. Useful when the form number is dynamic.\n * This functionality is added by default to [simpay id=\"13\"] shortcode usage.\n *\n *   <button data-form-id=\"13\">Launch</button>\n *   document.querySelector( '.my-button' ).addEventListener( 'click', simpayAppPro.toggleOverlayForm );\n *\n * @param {mixed} Click or change event, or an ID of a form.\n */\nexport function toggle( e, spFormElem, formData ) {\n\tlet formId = false;\n\n\tif ( 'object' === typeof e ) {\n\t\te.preventDefault();\n\t\tformId = e.target.dataset.formId;\n\t} else {\n\t\tformId = e;\n\t}\n\n\t// Find the modal.\n\tlet modal = document.querySelectorAll( '.simpay-modal[data-form-id=\"' + formId + '\"]' );\n\n\tif ( 0 === modal.length ) {\n\t\treturn;\n\t}\n\n\t// Always get the last instance of the modal markup since the markup\n\t// is moved to the end of the DOM.\n\t//\n\t// @link https://github.com/wpsimplepay/WP-Simple-Pay-Pro-3/issues/738\n\tmodal = modal[ modal.length - 1 ];\n\n\t// Move Modal markup to end of the document.\n\tdocument.body.appendChild( modal );\n\n\tconst modalStyles = getComputedStyle( modal );\n\tconst isVisible = '0' !== modalStyles.getPropertyValue( 'opacity' );\n\n\tif ( isVisible ) {\n\t\tmodal.style.opacity = 0;\n\t\tmodal.style.height = 0;\n\t} else {\n\t\tmodal.style.opacity = 1;\n\t\tmodal.style.height = '100%';\n\n\t\t// Find spFormElem and formData which lose context in global event binding.\n\t\t// The formData.formInstance will still be incorrect, but handled further\n\t\t// down for PRB.\n\t\tconst spFormElem = window.simpayApp.spFormElems[ formId ];\n\t\tconst formData = window.simpayApp.spFormData[ formId ];\n\n\t\tsetupPaymentRequestButton( e, spFormElem, formData );\n\n\t\t// Focus first field.\n\t\tfocusFirstField( modal );\n\t}\n}\n\n/**\n * Focus first field in an overlay form's modal.\n *\n * @param {HTMLElement} modal Modal being shown.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {HTMLElement} cardEl Card element to mount to.\n */\nfunction focusFirstField( modal ) {\n\t/**\n\t * Selectable elements.\n\t */\n\tconst SELECTOR = [\n\t\t'button:not([disabled])',\n\t\t'input:not([type=\"hidden\"]):not([aria-hidden]):not([disabled])',\n\t\t'select:not([disabled])',\n\t\t'textarea:not([disabled])',\n\t].join( ',' );\n\n\tconst firstModalField = modal.querySelector( SELECTOR );\n\n\tif ( firstModalField ) {\n\t\tfirstModalField.focus();\n\t\tfirstModalField.parentElement.classList.add( 'is-focused' );\n\t}\n}\n\nlet OVERLAYS_SETUP = false;\n\n/**\n * Manage modal toggling for \"Overlay\" form display types.\n *\n * Initial HTML markup for the modal is output as a sibling to the toggle\n * control but is moved to the end of the document to combat issues with z-index.\n *\n * @link https://github.com/wpsimplepay/WP-Simple-Pay-Pro-3/issues/610\n * @link https://github.com/wpsimplepay/WP-Simple-Pay-Pro-3/issues/645\n *\n * @param {Event} e Event.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {HTMLElement} cardEl Card element to mount to.\n */\nexport function setup( e, spFormElem, formData ) {\n\t// This function can be called multiple times with the\n\t// `simpayBindCoreFormEventsAndTriggers` trigger.\n\t//\n\t// Because we need to allow custom controls outside of the form context\n\t// we must query from the document level, not the <form>.\n\t//\n\t// Anonymous functions or functions created in this scope will stack\n\t// when attached to an element. To avoid keep access to the initial\n\t// form context we ensure nothing continues after this function is run once.\n\t//\n\t// @link https://github.com/wpsimplepay/WP-Simple-Pay-Pro-3/issues/958\n\tif ( true === OVERLAYS_SETUP ) {\n\t\treturn;\n\t}\n\n\tOVERLAYS_SETUP = true;\n\n\tconst inputControls = document.querySelectorAll( 'input.simpay-modal-control' );\n\tconst controls = document.querySelectorAll( '*:not(input).simpay-modal-control' );\n\n\t// Bind each control to toggle a modal.\n\t_.each( inputControls, function( control ) {\n\t\tcontrol.addEventListener( 'change', toggle );\n\t} );\n\n\t_.each( controls, function( control ) {\n\t\tcontrol.addEventListener( 'click', toggle );\n\t} );\n}\n","/**\n * Internal dependencies\n */\nimport { Cart as BaseCart } from '@wpsimplepay/cart';\nimport LineItem from './line-item.js';\n\n/**\n * Cart for Embedded/Overlay form types.\n *\n * @todo Move to /pro\n *\n * @since 3.7.0\n */\nexport const Cart = class Cart extends BaseCart {\n\t/**\n\t * @since 3.7.0\n\t *\n\t * @param {Object} args Cart arguments.\n\t */\n\tconstructor( args ) {\n\t\tsuper( args );\n\n\t\t// Define the type of line item to use.\n\t\tthis.LineItem = LineItem;\n\t}\n\n\t/**\n\t * Retrieves subtotal.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number} Cart subtotal.\n\t */\n\tgetSubtotal() {\n\t\tlet subtotal = 0;\n\n\t\tthis.getLineItems().forEach( ( item ) => {\n\t\t\tsubtotal += item.getSubtotal();\n\t\t} );\n\n\t\treturn subtotal;\n\t}\n\n\t/**\n\t * Retrieves the total discount amount.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number} Cart discount amount.\n\t */\n\tgetDiscount() {\n\t\tconst coupon = this.getCoupon();\n\t\tlet discount = 0;\n\n\t\tif ( false === coupon ) {\n\t\t\treturn discount;\n\t\t}\n\n\t\tconst {\n\t\t\tamount_off: amountOff,\n\t\t\tpercent_off: percentOff,\n\t\t} = coupon;\n\n\t\tif ( percentOff ) {\n\t\t\tthis.getLineItems().forEach( ( item ) => {\n\t\t\t\tdiscount += Math.round( item.getSubtotal() * ( percentOff / 100 ) );\n\t\t\t} );\n\t\t}\n\n\t\tif ( amountOff ) {\n\t\t\tdiscount += amountOff;\n\t\t}\n\n\t\treturn discount;\n\t}\n\n\t/**\n\t * Retrieves total tax amount.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number} Cart tax.\n\t */\n\tgetTax() {\n\t\tlet tax = 0;\n\n\t\tconst coupon = this.getCoupon();\n\t\tconst taxDecimal = this.getTaxDecimal();\n\t\tconst lineItems = this.getLineItems();\n\n\t\t// Calculate taxes with no coupon applied.\n\t\tif ( false === coupon ) {\n\t\t\tlineItems.forEach( ( item ) => {\n\t\t\t\ttax += Math.round( item.getSubtotal() * taxDecimal );\n\t\t\t} );\n\n\t\t\treturn tax;\n\t\t}\n\n\t\tconst {\n\t\t\tpercent_off: percentOff,\n\t\t\tamount_off: amountOff,\n\t\t} = coupon;\n\n\t\t// Calculate taxes with a %-based coupon applied.\n\t\t//\n\t\t// Stripe applies the discount percent to each line item before\n\t\t// calculating the tax amount of each and summing.\n\t\tif ( percentOff ) {\n\t\t\tlineItems.forEach( ( item ) => {\n\t\t\t\tconst lineItemDiscount = item.getSubtotal() * ( percentOff / 100 );\n\t\t\t\tconst lineItemSubtotal = item.getSubtotal() - lineItemDiscount;\n\n\t\t\t\ttax += Math.round( lineItemSubtotal * taxDecimal );\n\t\t\t} );\n\n\t\t\treturn tax;\n\t\t}\n\n\t\tconst subtotal = this.getSubtotal();\n\n\t\t// Calculate taxes with a fixed-amount coupon applied.\n\t\t//\n\t\t// Stripe applies the discount amount to the cart subtotal before\n\t\t// calculating the tax amount for the whole cart.\n\t\tif ( amountOff ) {\n\t\t\tconst cartSubtotal = subtotal - amountOff;\n\n\t\t\ttax += Math.round( cartSubtotal * taxDecimal );\n\n\t\t\treturn tax;\n\t\t}\n\t}\n\n\t/**\n\t * Retrieves the total.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number} Cart total.\n\t */\n\tgetTotal() {\n\t\tconst subtotal = this.getSubtotal();\n\t\tconst tax = this.getTax();\n\t\tconst discount = this.getDiscount();\n\n\t\treturn Math.round( ( subtotal - discount ) + tax );\n\t}\n};\n","/**\n * Internal dependencies\n */\nimport { LineItem as BaseLineItem } from '@wpsimplepay/cart';\n\n/**\n * LineItem\n */\nclass LineItem extends BaseLineItem {\n\t/**\n\t * Retrieves a cart line item's subtotal.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number} Cart line item subtotal.\n\t */\n\tgetSubtotal() {\n\t\treturn Math.round( this.getUnitPrice() * this.getQuantity() );\n\t}\n\n\t/**\n\t * Retrieves a cart line item's total.\n\t *\n\t * @since 3.7.0\n\t *\n\t * @return {number} Cart line item total.\n\t */\n\tgetTotal() {\n\t\treturn Math.round( this.getSubtotal() + this.getTax() );\n\t}\n}\n\nexport default LineItem;\n","/**\n * WordPress dependencies.\n */\nimport { addQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies.\n */\nimport {\n\tcreate as createCustomer,\n} from '@wpsimplepay/core/frontend/payments/customer.js';\n\nimport {\n\tcreate as createPaymentIntent,\n\thandleServerResponse as handlePaymentIntentServerResponse,\n} from '@wpsimplepay/pro/frontend/payments/paymentintent.js';\n\nimport {\n\tcreate as createSubscription,\n\thandleServerResponse as handleSubscriptionServerResponse,\n} from '@wpsimplepay/pro/frontend/payments/subscription.js';\n\nimport {\n\tgetElementsConfig,\n} from '@wpsimplepay/pro/frontend/payment-forms/stripe-elements';\n\nexport * from './cart';\n\n/**\n * Handle a Stripe Payment method.\n *\n * Depending on the form type, follow one of two flows:\n *\n * 1. https://stripe.com/docs/billing/subscriptions/payment\n * 2. https://stripe.com/docs/payments/payment-intents/quickstart#manual-confirmation-flow\n *\n * @param {Object} result Stripe createSource result.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport async function handle( result, spFormElem, formData ) {\n\tif ( result.error ) {\n\t\tthrow result.error;\n\t}\n\n\t// Customer is required for both flows.\n\tconst customer = await createCustomer(\n\t\t{\n\t\t\tsource_id: result.source.id,\n\t\t},\n\t\tspFormElem,\n\t\tformData\n\t);\n\n\tconst successUrl = addQueryArgs( formData.stripeParams.success_url, {\n\t\tcustomer_id: customer.id,\n\t} );\n\n\tlet paymentIntentRequiresAction;\n\n\tif ( formData.isSubscription || formData.isRecurring ) {\n\t\tconst subscription = await createSubscription(\n\t\t\t{\n\t\t\t\tcustomer_id: customer.id,\n\t\t\t},\n\t\t\tspFormElem,\n\t\t\tformData\n\t\t);\n\n\t\t// Handle next actions on Subscription's PaymentIntent.\n\t\tpaymentIntentRequiresAction = await handleSubscriptionServerResponse( subscription, spFormElem, formData );\n\t} else {\n\t\tconst paymentIntent = await createPaymentIntent(\n\t\t\t{\n\t\t\t\tcustomer_id: customer.id,\n\t\t\t\tpayment_method_id: result.source.id,\n\t\t\t},\n\t\t\tspFormElem,\n\t\t\tformData\n\t\t);\n\n\t\t// No SCA needed, redirect.\n\t\tif ( ! paymentIntent.requires_action ) {\n\t\t\treturn window.location.href = successUrl;\n\t\t}\n\n\t\t// Handle next actions on PaymentIntent.\n\t\tpaymentIntentRequiresAction = await handlePaymentIntentServerResponse(\n\t\t\t{\n\t\t\t\tcustomer_id: customer.id,\n\t\t\t\tpayment_intent: paymentIntent,\n\t\t\t},\n\t\t\tspFormElem,\n\t\t\tformData\n\t\t);\n\t}\n\n\t// Nothing else is needed, redirect.\n\tif ( false === paymentIntentRequiresAction ) {\n\t\treturn window.location.href = successUrl;\n\t}\n}\n\n/**\n * Sets up a Stripe Elements Card field and binds events.\n *\n * @link https://stripe.com/docs/stripe-js/reference#elements-create\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function setup( spFormElem, formData ) {\n\tconst elements = spFormElem.stripeInstance.elements();\n\tconst cardEl = spFormElem[ 0 ].querySelector( '.simpay-card-wrap' );\n\n\tif ( ! cardEl ) {\n\t\treturn;\n\t}\n\n\t// Create Element Card instance.\n\tspFormElem.cardElementInstance = elements.create(\n\t\t'card',\n\t\tgetElementsConfig( spFormElem, cardEl )\n\t);\n\n\t// Mount and setup Element card instance.\n\tspFormElem.cardElementInstance.mount( cardEl );\n\n\t// Enable form when Card field is ready.\n\tspFormElem.cardElementInstance.on( 'ready', () => window.simpayApp.enableForm( spFormElem, formData ) );\n\n\t// Live feedback when card updates.\n\tspFormElem.cardElementInstance.on( 'change', ( result ) => {\n\t\twindow.simpayApp.enableForm( spFormElem, formData );\n\n\t\tif ( result.error ) {\n\t\t\twindow.simpayApp.showError( spFormElem, formData, result.error.message );\n\t\t} else {\n\t\t\twindow.simpayApp.showError( spFormElem, formData, '' );\n\t\t}\n\t} );\n}\n\n/**\n * Creates a Card Source.\n *\n * @todo Switch to a true PaymentMethod.\n *       Stripe currently converts these behind the scenes.\n *       https://stripe.com/docs/stripe-js/reference#stripe-create-payment-method\n *\n * @link https://stripe.com/docs/stripe-js/reference#stripe-create-source\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n * @return {Promise}\n */\nexport function create( spFormElem, formData ) {\n\tconst {\n\t\tcurrency,\n\t} = formData;\n\n\tconst owner = getOwnerData( spFormElem, formData );\n\n\treturn spFormElem.stripeInstance\n\t\t.createSource(\n\t\t\tspFormElem.cardElementInstance,\n\t\t\t{\n\t\t\t\ttype: 'card',\n\t\t\t\tcurrency,\n\t\t\t\towner,\n\t\t\t}\n\t\t);\n}\n\n/**\n * Handles a Card Payment Method creation error.\n *\n * @param {Object} error Error object from Promise or general throw.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function onError( error, spFormElem, formData ) {\n\t// @todo DRY with other form handling.\n\tif ( ! _.isObject( error ) ) {\n\t\treturn;\n\t}\n\n\tconst {\n\t\tresponseJSON,\n\t\tresponseText,\n\t\tmessage,\n\t} = error;\n\n\tconst foundMessage = ( responseJSON && responseJSON.message ? responseJSON.message : responseText );\n\tconst errorMessage = message ? message : foundMessage;\n\n\tconst {\n\t\tshowError,\n\t\tenableForm,\n\t} = window.simpayApp;\n\n\tconst {\n\t\tdebugLog,\n\t} = window.spShared;\n\n\tshowError( spFormElem, formData, errorMessage );\n\tenableForm( spFormElem, formData );\n\n\tdebugLog( 'Payment Form Error:', error );\n}\n\n/**\n * Find card owner data in the form.\n *\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function getOwnerData( spFormElem, formData ) {\n\tconst billingAddressContainer = spFormElem.find( '.simpay-billing-address-container' );\n\n\tconst name = spFormElem.find( '.simpay-customer-name' ).val() || null;\n\tconst email = spFormElem.find( '.simpay-email' ).val() || null;\n\tconst phone = spFormElem.find( '.simpay-telephone' ).val() || null;\n\tconst address = 0 !== billingAddressContainer.length ? {\n\t\tline1: billingAddressContainer.find( '.simpay-address-street' ).val() || null,\n\t\tcity: billingAddressContainer.find( '.simpay-address-city' ).val() || null,\n\t\tstate: billingAddressContainer.find( '.simpay-address-state' ).val() || null,\n\t\tpostal_code: billingAddressContainer.find( '.simpay-address-zip' ).val() || null,\n\t\tcountry: billingAddressContainer.find( '.simpay-address-country' ).val() || null,\n\t} : null;\n\n\treturn {\n\t\tname,\n\t\temail,\n\t\tphone,\n\t\taddress,\n\t};\n}\n","/* global wpApiSettings */\n\n/**\n * External dependencies.\n */\nimport serialize from 'form-serialize';\n\n/**\n * Internal dependencies.\n */\nimport { apiRequest } from '@wpsimplepay/utils';\n\n/**\n * Create a Stripe\\PaymentIntent object based on current formData.\n *\n * @param {Object} data Data to pass to REST endpoint.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n * @return {Promise} AJAX promise.\n */\nexport function create( data, spFormElem, formData ) {\n\treturn apiRequest( 'v2/paymentintent/create', {\n\t\tform_values: serialize( spFormElem[ 0 ], { hash: true } ),\n\t\tform_data: formData,\n\t\tform_id: formData.formId,\n\t\t...data,\n\t} );\n}\n\n/**\n * Verify a PaymentIntent after any required actions.\n *\n * @param {Object} data Data to pass to REST endpoint.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n * @return {Promise} AJAX promise.\n */\nexport function confirm( data = {}, spFormElem, formData ) {\n\treturn apiRequest( 'v2/paymentintent/confirm', {\n\t\tform_values: serialize( spFormElem[ 0 ], { hash: true } ),\n\t\tform_data: formData,\n\t\tform_id: formData.formId,\n\t\t...data,\n\t} );\n}\n\n/**\n * Handle server response/next actions for a PaymentIntent.\n *\n * @param {Object} response Server response object.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function handleServerResponse( data, spFormElem, formData ) {\n\tconst {\n\t\tpayment_intent: paymentIntent,\n\t\tcustomer_id,\n\t} = data;\n\n\tif ( ! paymentIntent.requires_action ) {\n\t\treturn false;\n\t}\n\n\t// Handle a PaymentIntent that requires action.\n\treturn spFormElem.stripeInstance\n\t\t.handleCardAction( paymentIntent.payment_intent_client_secret )\n\t\t.then( async ( result ) => {\n\t\t\tconst { error, paymentIntent: paymentIntentAction } = result;\n\n\t\t\tif ( error ) {\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tconst paymentIntentConfirmation = await confirm(\n\t\t\t\t{\n\t\t\t\t\tpayment_intent_id: paymentIntentAction.id,\n\t\t\t\t\tcustomer_id,\n\t\t\t\t},\n\t\t\t\tspFormElem,\n\t\t\t\tformData\n\t\t\t);\n\n\t\t\treturn handleServerResponse(\n\t\t\t\t{\n\t\t\t\t\tpayment_intent: paymentIntentConfirmation,\n\t\t\t\t\tcustomer_id,\n\t\t\t\t},\n\t\t\t\tspFormElem,\n\t\t\t\tformData\n\t\t\t);\n\t\t} );\n}\n","/* global wpApiSettings */\n\n/**\n * External dependencies.\n */\nimport serialize from 'form-serialize';\n\n/**\n * Internal dependencies.\n */\nimport { apiRequest } from '@wpsimplepay/utils';\n\n/**\n * Create a Subscription object based on current formData.\n *\n * @param {Object} data Data to pass to REST endpoint.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n * @return {Promise} AJAX promise.\n */\nexport function create( data = {}, spFormElem, formData ) {\n\treturn apiRequest( 'v2/subscription', {\n\t\tform_values: serialize( spFormElem[ 0 ], { hash: true } ),\n\t\tform_data: formData,\n\t\tform_id: formData.formId,\n\t\t...data,\n\t} );\n}\n\n/**\n * Update a Subscription's payment method.\n *\n * Requires a Subscription's key and linked Customer for verification.\n * Takes direct arguments vs. spFormElem and full form data.\n *\n * @param {string} subscription_id ID of the Subscription.\n * @param {Object} form_values {\n *\n *   @type {string} nonce Form nonce.\n *   @type {string} subscription_key Subscription secret key.\n *   @type {string} source_id ID of the Source.\n *   @type {string} customer_id ID of the Customer.\n * }\n * @return {Promise} AJAX promise.\n */\nexport function updatePaymentMethod( subscription_id, args ) {\n\tconst {\n\t\tcustomer_id,\n\t} = args;\n\n\treturn apiRequest( `v2/subscription/payment_method/${ subscription_id }/${ customer_id }`, {\n\t\tform_values: args,\n\t} );\n}\n\n/**\n * Handle server response/next actions for a PaymentIntent.\n *\n * Use the Subscription's invoice to determine if action needs ot be taken.\n *\n * @param {Object} subscription \\Stripe\\Subscription.\n * @param {jQuery} spFormElem Form element jQuery object.\n * @param {Object} formData Configured form data.\n */\nexport function handleServerResponse( subscription, spFormElem, formData ) {\n\tconst {\n\t\tstatus,\n\t\tlatest_invoice: {\n\t\t\tpayment_intent: paymentIntent,\n\t\t},\n\t\tpending_setup_intent: setupIntent,\n\t} = subscription;\n\n\tconst {\n\t\tstripeParams: {\n\t\t\tsuccess_url: successUrl,\n\t\t\terror_url: errorUrl,\n\t\t},\n\t} = formData;\n\n\tif ( ! ( paymentIntent || setupIntent ) ) {\n\t\treturn false;\n\t}\n\n\t// Initial charge is required.\n\tif ( paymentIntent ) {\n\t\tconst {\n\t\t\tstatus: paymentIntentStatus,\n\t\t\tclient_secret: paymentIntentClientSecret,\n\t\t\tlast_payment_error: paymentIntentError,\n\t\t} = paymentIntent;\n\n\t\t// Subscription is active, and intent needs no further action.\n\t\t// Subscription is trialing, and intent needs no further action.\n\t\tif (\n\t\t\t( 'active' === status && 'succeeded' === paymentIntentStatus ) ||\n\t\t\t( 'trialing' === status && 'succeeded' === paymentIntentStatus )\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Could not complete with current payment method, allow client to try again.\n\t\tif ( 'incomplete' === status && 'requires_payment_method' === paymentIntentStatus ) {\n\t\t\tif ( paymentIntentError.message ) {\n\t\t\t\tthrow {\n\t\t\t\t\tmessage: paymentIntentError.message,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\t// Handle 3D Secure.\n\t\tif ( 'incomplete' === status && 'requires_action' === paymentIntentStatus ) {\n\t\t\treturn spFormElem.stripeInstance.handleCardPayment(\n\t\t\t\tpaymentIntentClientSecret\n\t\t\t)\n\t\t\t\t.then( ( result ) => {\n\t\t\t\t\tif ( result.error ) {\n\t\t\t\t\t\tthrow result.error;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t} );\n\t\t}\n\t}\n\n\t// No initial charge needed, setup for future.\n\tif ( setupIntent ) {\n\t\tconst {\n\t\t\tstatus: setupIntentStatus,\n\t\t\tclient_secret: setupIntentClientSecret,\n\t\t} = setupIntent;\n\n\t\t// Handle 3D Secure.\n\t\tif ( 'requires_action' === setupIntentStatus ) {\n\t\t\treturn spFormElem.stripeInstance.handleCardSetup(\n\t\t\t\tsetupIntentClientSecret\n\t\t\t)\n\t\t\t\t.then( ( result ) => {\n\t\t\t\t\tif ( result.error ) {\n\t\t\t\t\t\tthrow result.error;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t} );\n\t\t// Could not complete with current payment method, allow client to try again.\n\t\t} else if ( 'requires_payment_method' === setupIntentStatus ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t// Unhandled status. Direct to error page.\n\treturn window.location.href = errorUrl;\n}\n","module.exports = jQuery;"],"sourceRoot":""}